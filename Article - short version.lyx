#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass IEEEtran
\begin_preamble
% for subfigures/subtables
\usepackage{titlesec}
\titlespacing{\subsubsection}{0pt}{0.6em}{0pt}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{diagbox}
\usepackage{array}
\usepackage{listings}
\lstdefinelanguage{Swift}{language=bash,morekeywords={fix},}
\usepackage{color}
\definecolor{lightgray}{RGB}{246,246,246}
\definecolor{darkgray}{RGB}{128,128,128}
\end_preamble
\options journal
\use_default_options false
\begin_modules
graphicboxes
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding ascii
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "Your Title"
\pdf_author "Your Name"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle false
\pdf_quoted_options "pdfpagelayout=OneColumn, pdfnewwindow=true, pdfstartview=XYZ, plainpages=false"
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine biblatex-natbib
\cite_engine_type numerical
\biblio_style jurabib
\biblatex_bibstyle ieee
\biblatex_citestyle numeric
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 2
\papersides 1
\paperpagestyle default
\listings_params "breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\scriptsize\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\scriptsize\ttfamily},xleftmargin={0.7cm},framexleftmargin={0.7em},numbersep=8pt,tabsize=3,backgroundcolor={\color{lightgray}},commentstyle={\color{darkgray}}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Automatic Classification of Plutonic Rocks with Machine Learning Applied
 to Extracted Shades and Colors on iOS Devices
\end_layout

\begin_layout Author

\series bold
Sarah Hernández
\series default
 is a computer science engineering student at the School of Engineering
 and Technology of Montemorelos University, Montemorelos, Nuevo León, Mexico.
\begin_inset Newline newline
\end_inset

Address: ?.
 E-mail: 
\begin_inset CommandInset href
LatexCommand href
target "1170469@alumno.um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset VSpace defskip
\end_inset


\series bold
Germán H.
 Alferez, Ph.D.
\series default
, is the director of the Institute of Data Science and professor at the
 School of Engineering and Technology of Montemorelos University, Montemorelos,
 Nuevo León, Mexico.
\begin_inset Newline newline
\end_inset

Address: ?.
 E-mail: 
\begin_inset CommandInset href
LatexCommand href
target "harveyalferez@um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset VSpace defskip
\end_inset


\series bold
Benjamin L.
 Clausen, Ph.D.
\series default
, is a professor at the Department of Earth and Biological Sciences and
 researcher at the Geoscience Research Institute, Loma Linda University,
 Loma Linda, California, USA.
\begin_inset Newline newline
\end_inset

Address: ?.
 E-mail: 
\begin_inset CommandInset href
LatexCommand href
target "bclausen@llu.edu"
literal "false"

\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset VSpace defskip
\end_inset


\series bold
Ana M.
 Martínez, Ph.D.
\series default
, is a professor at the Department of Earth and Biological Sciences of Loma
 Linda University, Loma Linda, California, USA.
\begin_inset Newline newline
\end_inset

Address: ?.
 E-mail: 
\begin_inset CommandInset href
LatexCommand href
target "anmartinez@llu.edu"
literal "false"

\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset VSpace defskip
\end_inset


\series bold
Type of the submission:
\series default
 "Regular Research Paper"
\end_layout

\begin_layout Abstract
Lightness and color are properties used for the classification of plutonic
 rocks but are difficult to describe because they depend on the experience
 of the observer.
 Moreover, this classification using various instrumental techniques tend
 to be expensive and time-consuming.
 We extracted dominant shades and colors from 283 plutonic rock images in
 RGB and CIELAB formats to train several machine learning models.
 The best model was deployed on an iOS application that classifies four
 classes of plutonic rocks: gabbro, diorite, granodiorite, and granite.
 The best results were for the K-Nearest Neighbors model using CIELAB dominant
 colors with accuracy, precision, recall, and F1-score of 93%.
 Comparisons were made with our model presented in a previous work trained
 by using all image features.
\end_layout

\begin_layout Keywords
Plutonic Rock Classification, Feature Extraction, Dominant Colors, Machine
 Learning, iOS Application.
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Plutonic rocks are formed when magma cools and solidifies below the Earth’s
 surface.
 Lightness and color are properties used for the classification of these
 rocks.
 Color changes in rocks may indicate changes in other rock properties (mineral
 assemblage, texture, organic carbon content, and more), that is why color
 is a key property for rock classification.
 However, these attributes are difficult to describe because perceived shades
 and colors in rocks depend on the observer's experience 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
 Moreover, the instruments for accurate rock classification are time-consuming
 and expensive making it prohibitive for geology students and amateurs.
 In addition, there is a lack of mobile tools for plutonic rock classification
 in the field using machine learning.
\end_layout

\begin_layout Standard
This research extracts dominant shades and colors from plutonic rock images
 to train several machine learning algorithms and deploy the best model
 on an iOS application for the automatic classification of four classes
 of plutonic rocks from darkest to lightest: gabbro, diorite, granodiorite,
 and granite.
 There are two reasons to create an application that classifies plutonic
 rocks with machine learning using their dominant colors.
 The dominant colors represent the principal color values of all the pixels
 in an image.
 First, no such application exists.
 A mobile application could offer the flexibility to carry out the classificatio
n in real time and could be an alternative to expensive traditional methods
 of rock classification.
 Second, we extracted the dominant colors to verify if feature reduction
 leads to better results in the classification of plutonic rocks than the
 obtained with the model trained in our previous work [ref] using all the
 image features.
 
\end_layout

\begin_layout Standard
The main contributions of this paper are four-folds:
\end_layout

\begin_layout Itemize
Determine the best 
\shape italic
k
\shape default
 number of clusters to use in the K-means clustering machine learning method
 to extract the dominant colors in terms of RGB and CIELAB color spaces
 from 283 images of plutonic rocks.
\end_layout

\begin_layout Itemize
Use the extracted dominant colors and the percentage of pixels belonging
 to each color cluster as the input to train the following machine learning
 algorithms: Logistic Regression (LR), K-Nearest Neighbors (KNN), Decision
 Trees (DT), Support Vector Machine (SVM), and a Convolutional Neural Network
 (CNN).
\end_layout

\begin_layout Itemize
Validate the models generated by means of the accuracy, precision and recall
 metrics.
 The best model is deployed in an iOS mobile application.
\end_layout

\begin_layout Itemize
Compare the best model validation results with the CNN of our previous work
 trained with the whole set of rock image features.
\end_layout

\begin_layout Subsection
Underpinnings of our Approach
\end_layout

\begin_layout Standard
Our approach is based on the following concepts 
\shape italic
\emph on
(see Fig.
 
\shape default
\emph default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Underpinnings-of-our"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Springer - Map of concepts.png
	lyxscale 20
	width 100col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Underpinnings of our approach 
\begin_inset CommandInset label
LatexCommand label
name "fig:Underpinnings-of-our"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Plutonic rocks
\end_layout

\begin_layout Standard
Plutonic rocks crystalize inside the Earth’s crust from magma are generally
 coarse-grained and compositionally classified by the proportion of minerals
 in it.
 According to 
\begin_inset CommandInset citation
LatexCommand citep
key "RACEFEN-gg"
literal "false"

\end_inset

:
\end_layout

\begin_layout Itemize
Gabbro is a plutonic rock composed mainly of calcium plagioclase and pyroxene,
 with or without olivine or amphibole.
 It is the intrusive equivalent of basalt and is distinguished from diorite
 by the nature of plagioclase, which is higher in calcium than in sodium.
\end_layout

\begin_layout Itemize
Diorite has about the same structural properties as granite but darker color
 and more limited occurrence.
 Commonly it is composed of about two-thirds plagioclase feldspar and one-third
 dark-coloured minerals, such as hornblende or biotite.
 The presence of more sodium-rich plagioclase and less calcium-rich plagioclase
 is the main distinction between diorite and gabbro 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Diorite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Granodiorite is characterized by quartz with plagioclase constituting more
 than 2/3 of the total feldspars.
 Generally, together with granite, it is the most abundant rock of the great
 batholiths.
 Its volcanic equivalent is dacite.
 Granodiorite is similar to granite, but with less potassium feldspar and
 more plagioclase, hornblende, and biotite.
\end_layout

\begin_layout Itemize
Granite is a light-colored rock characterized by coarse to medium crystal
 size, composed of approximately equal amounts of quartz, potassium feldspar,
 and plagioclase as essential minerals, and smaller amounts of other minerals,
 such as biotite, muscovite or hornblende.
\end_layout

\begin_layout Subsubsection
Machine Learning
\end_layout

\begin_layout Standard
Machine learning is a branch of artificial intelligence that lies at the
 intersection between computer science, engineering and statistics, and
 often appears in other disciplines.
 Machine learning systems can be classified according to the type of supervision
 they get during training 
\begin_inset CommandInset citation
LatexCommand citep
key "Harrington2012,Geron2019"
literal "false"

\end_inset

.
 In this way, there are two major categories:
\end_layout

\begin_layout Paragraph
Supervised learning
\end_layout

\begin_layout Standard
In supervised learning, a typical task is classification.
 The training set fed to the algorithm includes the desired solutions, called
 labels 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
 Some common supervised learning algorithms are described as follows:
\end_layout

\begin_layout Itemize
Logistic Regression (LR) is commonly used to estimate the probability that
 an instance belongs to a particular class.
 LR computes a weighted sum of the input features (plus a bias term) and
 outputs the logistic of this result.
 The logistic is a sigmoid function that outputs a number between 0 and
 1.
 This makes LR a binary classifier 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
K-Nearest Neighbors (KNN) is used to predict the label of a new point finding
 a predefined number of training samples closest in distance to that point.
 Being a non-parametric method, it is often successful in classifications
 where the decision boundary is very irregular 
\begin_inset CommandInset citation
LatexCommand citep
key "Buitinck2013"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Decision Trees (DT) algorithm consists of split nodes and leaf nodes.
 Each split node performs a split decision and routes a data sample either
 to the left or the right child node.
 Leaves represent the labels, non-leaf nodes are the input features, and
 branches represent conjunctions of features that lead to the classifications
 
\begin_inset CommandInset citation
LatexCommand citep
key "REINDERS201965,TAN2015493"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Support Vector Machine (SVM) is a powerful and versatile algorithm, particularly
 well suited for classification of complex small- or medium-sized datasets.
 The data is plotted in a n-dimensional space (number of features) and a
 decision boundary (hyperplane) splits that space into classes 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019,Harrington2012"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Convolutional Neural Networks (CNNs) emerged from the study of the brain’s
 visual cortex.
 The CNN´s architecture consists of several connected layers allowing the
 network to concentrate on small low-level features in the first hidden
 layer to assemble them into larger higher-level features in the next layers.
 Their most important building block is the convolutional layer 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Unsupervised learning
\end_layout

\begin_layout Standard
In unsupervised learning the training data is unlabeled.
 K-means is one of the most important algorithms capable of clustering unlabeled
 data very quickly and efficiently, often in a few iterations.
 Its goal is to group similar instances together into a 
\shape italic
k
\shape default
 number of clusters assigning each instance to one of the clusters 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Dominant colors
\end_layout

\begin_layout Standard
The dominant colors refer to the principal colors presented in an image.
 These colors are selected grouping the image pixels according to their
 color in the selected color space (RGB or CIELAB) represented as a three-value
 vector.
 The average color of each group is a dominant color and its percentage
 is the number of pixels in that group.
\end_layout

\begin_layout Standard
In RGB (Red, Green, Blue), the light spectra of varying fractions of the
 three primary color channels combine to make new colors.
 Each channel has intensity values from 0 to 1 scaled by the number of bits
 used to represent it.
 The 24-bit color cube used in this research scales the channel values in
 the range of 0–255 
\begin_inset CommandInset citation
LatexCommand citep
key "Wallace2002"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
On the other hand, CIELAB has the property of being perceptually uniform
 (useful to measure the similarity between two colors) and is designed to
 approximate human vision.
 The L channel represents the brightness of each pixel varying between 0
 and 100.
 The 
\shape italic
a
\shape default
 (red/green) and 
\shape italic
b
\shape default
 (yellow/blue) channels correspond to the chromaticity components and contain
 information about the color of a pixel, independent of its brightness.
 Their values vary between -127 and 127 
\begin_inset CommandInset citation
LatexCommand citep
key "DavidMillanEscriva2019,Young2009"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Underlying technologies
\end_layout

\begin_layout Paragraph
Scikit-learn
\end_layout

\begin_layout Standard
Scikit-learn is a Python module that integrates a wide range of state-of-the-art
 machine learning algorithms for medium-scale supervised and unsupervised
 problems.
 This library focuses on bringing machine learning to non-specialists using
 a general-purpose high-level language.
 Emphasis is put on ease of use, performance, documentation, and API consistency.
 It has minimal dependencies and is distributed under the simplified Berkeley
 Source Distribution (BSD) license, encouraging its use in both academic
 and commercial settings 
\begin_inset CommandInset citation
LatexCommand citep
key "scikit-learn"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow
\end_layout

\begin_layout Standard
TensorFlow
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://www.tensorflow.org
\end_layout

\end_inset

 is an interface for expressing machine learning algorithms and an implementatio
n for executing such algorithms.
 A computation expressed using TensorFlow can be executed with little or
 no change on a wide variety of heterogeneous systems, ranging from mobile
 devices such as phones and tablets up to large-scale distributed systems
 with hundreds of machines and thousands of computational devices such as
 Graphics Processing Unit (GPU) cards 
\begin_inset CommandInset citation
LatexCommand citep
key "Abadi2016"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow Lite
\end_layout

\begin_layout Standard
TensorFlow Lite 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://www.tensorflow.org/lite
\end_layout

\end_inset

 is a set of tools to help developers run TensorFlow machine learning models
 on mobile, embedded, and Internet of Thnigs (IoT) devices 
\begin_inset CommandInset citation
LatexCommand citep
key "TF-TFLite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
TensorFlow Lite consists of two main components:
\end_layout

\begin_layout Itemize
The interpreter, which runs specially optimized models on many different
 hardware types.
\end_layout

\begin_layout Itemize
The converter, which converts TensorFlow models into an efficient form for
 use by the interpreter, and can introduce optimizations to improve them.
\end_layout

\begin_layout Paragraph
Swift
\end_layout

\begin_layout Standard
Swift
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://swift.org
\end_layout

\end_inset

 is an open source programming language designed by Apple for Apple platforms
 and is better in type safety, security, and hardware performance than Objective
-C.
 Community members actively work to port it even to more platforms like
 Linux 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Swift"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Xcode
\end_layout

\begin_layout Standard
Xcode
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://developer.apple.com/xcode/
\end_layout

\end_inset

 consists of a suite of tools that developers use to build apps for Apple
 platforms.
 It is used to manage entire development workflows from creating an application
 to testing, optimizing, and submitting it to the App Store 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Xcode"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
CocoaPods
\end_layout

\begin_layout Standard
CocoaPods
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://cocoapods.org
\end_layout

\end_inset

 is a dependency manager for Swift and Objective-C Cocoa projects.
 It resolves dependencies between libraries, fetches the resulting source
 code, then links it together in an Xcode workspace to build a single project
 
\begin_inset CommandInset citation
LatexCommand citep
key "CocoaPods"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Related Work
\end_layout

\begin_layout Standard
\begin_inset Float table
placement !t
wide true
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison table of the articles described in the related work 
\begin_inset CommandInset label
LatexCommand label
name "tab:Related-work-comparison"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="8">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="3.3em">
<column alignment="center" valignment="middle" width="2em">
<column alignment="center" valignment="middle" width="11.1em">
<column alignment="center" valignment="middle" width="5.2em">
<column alignment="center" valignment="middle" width="7.8em">
<column alignment="center" valignment="middle" width="3.8em">
<column alignment="center" valignment="middle" width="5.8em">
<column alignment="center" valignment="middle" width="11.8em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Author
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Year
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dataset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Algorithm of extraction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Training dataset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Best model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model results
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vázquez and Alférez [ref]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2021
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
423 patches from 259 images of six plutonic rock types (gabbro, diorite,
 tonalite, monzodiorite, granodiorite, and granite)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Augmen-ted data from the patches
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-layer CNN using gabbro, diorite, granodiorite, and granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy, recall, and F1-score: 95%
\end_layout

\begin_layout Plain Layout
Precision: 96%
\end_layout

\begin_layout Plain Layout
Execution time: 353.74 ms
\end_layout

\begin_layout Plain Layout
File size: 2.6 MB
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fan et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2020
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,208 images of 28 rock lithology categories
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SqueezeNet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 94.55%
\end_layout

\begin_layout Plain Layout
File size: 9.2 MB
\end_layout

\begin_layout Plain Layout
Execution time: 736-366 ms
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fan et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020a"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2020
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,795 images of 30 different rock types
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ShuffleNet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 95.30%
\end_layout

\begin_layout Plain Layout
File size: 18.2 MB
\end_layout

\begin_layout Plain Layout
Execution time: 786 ms
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ran et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14,589 patches from 2,290 images of six rock types (granite, limestone,
 conglomerate, sandstone, shale, mylonite)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60% of the patches
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3-layer CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 97.76%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Zhang et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell mroffset="10cm" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
481 images of four minerals (K-feldspar, perthite, plagioclase, and quartz)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Inception-v3 CNN model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
High-level features (chromatic aberration, texture, and more)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
90% of extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stacking model (LR, SVM, and MLP)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 90.9%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maitre et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,192 sub-images of the views taken at different angles to a surface with
 27 mineral grain species
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SLIC algorithm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Color and Peak intensity of superpixel histograms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70% of extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random Forest (RF)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 89%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cheng and Guo 
\begin_inset CommandInset citation
LatexCommand citep
key "Cheng2017"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2017
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,200 images of three feldspar sandstone rock types (coarse, medium granular,
 and fine)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
75% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6-layer CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 98.5%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Over the last decade, there has been considerable progress in the application
 of machine learning to geochemistry 
\begin_inset CommandInset citation
LatexCommand citep
key "Lary2018"
literal "false"

\end_inset

.
 In this section we present relevant research work in three areas: image
 classification of rock lithology using machine learning, rock classification
 with machine learning on mobile devices, and recognition of mineral images
 applying machine learning and feature extraction.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Related-work-comparison"
plural "false"
caps "false"
noprefix "false"

\end_inset

 summarizes the works presented in this section.
\end_layout

\begin_layout Subsubsection
Image classification of rock lithology using machine learning
\end_layout

\begin_layout Standard
In our previous work [ref], we trained a CNN model with several combinations
 of plutonic rock classes to classify plutonic rocks using machine learning.
 The dataset contained 259 images of diorite, gabbro, tonalite, monzodiorite,
 granodiorite, and granite classified based on petrographic analysis of
 Cretaceous granitoids collected from Peru.
 The number of images was increased to 423 patches from around 450 × 700
 to 900 × 1000 pixels generated from the original dataset.
 The model created was 4-layer structure: two convolutional, and two fully-conne
cted layers.
 After each convolutional layer it was a max pooling layer of 2×2 size,
 and a flatten and a dropout layers before the first and second fully connected
 layers respectively.
 The model was trained with several combinations of the rock classes, 100
 epochs, and a batch size of 32.
 Data augmentation was applied to the image patches during training.
 The best combination of plutonic rocks was: gabbro, diorite, granodiorite,
 and granite achieving an accuracy, recall, and F1-score of 95%, and an
 average precision value of 96%.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019"
literal "false"

\end_inset

, Ran et al.
 proposed a CNN model for the classification of six rock types (granite,
 limestone, conglomerate, sandstone, shale, mylonite) and compared their
 results with four other common machine learning models.
 A total of 2,290 images were labeled according to the clarity of the rock
 and cropped into 14,589 sample patches of 512 × 512 pixels compressed to
 128 × 128 pixels.
 60% of the patches of each rock type were selected for the training dataset,
 20% for the validation dataset, and 20% for the testing dataset.
 Their proposed CNN model achieved the highest overall accuracy of 97.76%
 compared with the other models: SVM, AlexNet, GoogleLeNet Inception v3,
 and VGGNet-16.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Cheng2017"
literal "false"

\end_inset

, Cheng and Guo proposed a deep CNN to identify the granularity of feldspar
 sandstone rocks in images under three color spaces: RGB, YCbCr, and HSV.
 A total of 4,200 images were collected from rocks of an oil field in Ordos
 and divided into three types of granularity: coarse, medium granular, and
 fine.
 The RGB images were normalized to 224 × 224 pixels and converted to YCbCr
 and HSV.
 The proposed CNN was a 6-layer structure of 4 convoluted layers with ReLU
 as the activation function and 2 fully connected layers with Softmax as
 the classifier.
 The model was trained for each color space with 75% of the experimental
 data, a batch size of 100, and different kernel sizes and learning rates.
 The lowest error rates were obtained with the learning rate of 0.0005, the
 kernel sizes of 11, 5, 3, and 3 for each convolutional layer respectively,
 and the cross-validation for HSV color space.
 In RGB color space, the classification accuracy achieved 98.5%.
\end_layout

\begin_layout Subsubsection
Rock classification with machine learning on mobile devices
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020"
literal "false"

\end_inset

, Fan et al.
 created a method for rock lithology recognition on Android devices based
 on the two lightweight SqueezeNet and MobileNet CNNs.
 These models were compared with ResNet50, a heavyweight model.
 The images were selected from the China Geological Survey dataset that
 contains images of 28 rock categories taken by a smartphone camera.
 The 3,208 images were reduced to 214 × 214 pixels and the 80% were used
 to train the two CNNs pretrained with ImageNet dataset.
 The achieved occupation sizes were 19.6, 36.8, and 232.7 MB for MobileNet,
 SqueezeNet, and ResNet50.
 SqueezeNet was almost two times faster than MobileNet, and 7 times faster
 than ResNet50.
 A rock recognition software based on the trained models was developed for
 Android devices.
 The results for SqueezeNet and MobileNet on Android smartphones were: execution
 time from 736 to 366 and 1,218 to 523 milliseconds, and recognition accuracies
 of 94.55% and 93.27%.
\end_layout

\begin_layout Standard
Also in 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020a"
literal "false"

\end_inset

, Fan et al.
 improved their work using a model based on ShuffleNet for quick and accurate
 rock lithology recognition with smartphones and compared it with their
 previous work of MobileNet and SqueezeNet.
 They selected 3,795 images of 30 different kinds of rocks collected from
 multiple locations in East China.
 The ShuffleNet model was trained using 80% of the dataset, 3,600 iteration
 steps, a learning rate of 0.008, and the parameters imported by the transfer
 learning method using the ImageNet dataset.
 ShuffleNet occupied a space of 18.2 MB compared with MobileNet, SqueezeNet,
 and ResNet50 that occupied 34.5, 25, and 219.4 MB respectively.
 An Android application was created using each model.
 The average recognition time for a single rock in ShuffleNet was 786 millisecon
ds.
 It reached an accuracy of 97.65% on PC.
\end_layout

\begin_layout Subsubsection
Recognition of mineral images applying machine learning and feature extraction
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset

, Zhang et al.
 worked on the intelligent identification of rock-mineral images using ensemble
 machine learning algorithms (model stacking).
 A total of 481 images of four minerals (K-feldspar, perthite, plagioclase,
 and quartz) were obtained with the camera on top of a microscope.
 The target RGB images were cropped to cover the minerals and then processed
 to be 299 × 299 pixels.
 A deep learning model based on Inception-v3 was adopted to extract high-level
 features (such as chromatic aberration and texture) from the images and
 train the algorithms of LR, SVM, KNN, Random Forest (RF), Multilayer Perceptron
 (MLP), and Gaussian Naive Bayes (GNB).
 LR, SVM, and MLP had a significant effect on extracted features, with higher
 accuracy (90.0%, 90.6%, and 89.8%) than the other models.
 The new features generated by these three models were employed for the
 model stacking in a new instance of LR.
 The stacking model showed a better performance than the single models,
 with an accuracy of 90.9%.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset

, Maitre et al.
 created several models of supervised machine learning to recognize mineral
 grains in a sample surface containing grains of 27 different mineral species
 (plagioclase, augite, background, hypersthene, ilmenite, magnetite, titanite,
 hornblende, etc.).
 The surface was scanned with an automated Scanning Electron Microscopy
 (SEM) that assigned to each grain a mineral specie based on its chemical
 signature.
 Several views of the same surface were taken with a stereo-zoom binocular
 microscope to construct a large mosaic RGB image.
 Both images were divided into 3,192 sub-images of 600 × 600 pixels.
 To label the grains of the mosaic image, the simple linear iterative clustering
 (SLIC) algorithm was applied for superpixel segmentation to match each
 superpixel of the mosaic's sub-images with the superpixels of the SEM's
 scan sub-images.
 From the computed RGB superpixel histograms, the color intensity (quantile)
 and peak intensity (ratio between the number of pixels in the first and
 second maximum bins to total number of pixels) were extracted as features
 for each superpixels.
 KNN, RF, and Classification and Regression Trees (CART) algorithms were
 trained with 70% of the extracted features, and tested with the other 30%
 using the kappa statistics, precision, recall, and f1-score indicators.
 The RF algorithm gave the best results with a global accuracy of 89%.
\end_layout

\begin_layout Subsubsection
Discussion
\end_layout

\begin_layout Standard
Machine learning has been an effective way for image classification in geochemis
try.
 Specifically, feature reduction was applied in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019,Maitre2019"
literal "false"

\end_inset

 using deep learning and the simple linear iterative clustering (SLIC) algorithm
 to extract high-level features from images of mineral samples before training
 the machine learning models.
 Although these works showed good results in the classification of mineral
 samples, the number of extracted features was very large.
\end_layout

\begin_layout Standard
Four articles 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a,Ran2019,Cheng2017"
literal "false"

\end_inset

 introduce CNN topologies and analyze the performance of the models generated
 for rock lithology classification using all the image features.
 Also, in our previous work [ref], several combinations of plutonic rock
 images of 4 classes were analyzed using all the image features to train
 a CNN model rather than extracted features.
 The occurrence of redundant or irrelevant features in the acquired data
 makes the model learn based on irrelevant features
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
doi: https://doi.org/10.1016/B978-0-12-817913-0.00014-6
\end_layout

\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a"
literal "false"

\end_inset

 the created models were deployed on an Android mobile application for the
 classification of rocks.
 However, there are no works presenting the deployment of machine learning
 models on iOS devices.
\end_layout

\begin_layout Standard
Finally, the evaluation of the models in 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a,Ran2019,Cheng2017"
literal "false"

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
20, 21, 22, 25 ???
\end_layout

\end_inset

 showed good results in the classification of rock lithology.
 Nevertheless, all of them were trained with diverse types of rocks instead
 of using only the plutonic rock type.
 This type of classification becomes more difficult because rocks of the
 same type have very similar characteristics.
\end_layout

\begin_layout Section
Materials and Methods
\end_layout

\begin_layout Standard
This section describes the steps followed in this research work.
\end_layout

\begin_layout Subsection
Getting the images of the plutonic rocks
\end_layout

\begin_layout Standard
The images of plutonic rocks were provided by the Department of Earth and
 Biological Sciences at Loma Linda University.
 We use pictures from plutonic rocks that were classified by using petrography
 and chemistry data.
 Specifically, the dataset contains 283 image patches selected from the
 81 original images of four classes of plutonic rocks: gabbro, diorite,
 granodiorite, and granite.
 The images used in the following experiments are organized in subfolders
 according to their class and are available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/tree/main/Rock-images
\end_layout

\end_inset

.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Number-of-images"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the number of images per class.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Number of images per class 
\begin_inset CommandInset label
LatexCommand label
name "tab:Number-of-images"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="7em">
<column alignment="center" valignment="middle" width="8.3em">
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Number of images
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
65
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
78
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Total of images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
283
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Preparing the data
\end_layout

\begin_layout Standard
In this step, the images were processed in order to obtain the color values
 of the image pixels in RGB and CIELAB color spaces.
\end_layout

\begin_layout Standard
First, all files (
\begin_inset Quotes eld
\end_inset

.png
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

.jpg
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

.jpeg
\begin_inset Quotes erd
\end_inset

) in the subfolders of the main directory of images were processed in RGB
 format and labeled according to their container subfolder (e.g.
 processed images in the granite subfolder are labeled as granite).
 Thereafter, the RGB values of the image pixels were converted to CIELAB
 values using the 
\begin_inset Quotes eld
\end_inset

rgb2lab
\begin_inset Quotes erd
\end_inset

 function of the color class imported from the Scikit-image module.
 In this way, it is possible to train the models in the two color spaces
 and determine which color format is the most appropriate for classifying
 the dominant colors of the 4 classes of plutonic rocks.
 The notebook with the source code for data preparation is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
http://bit.ly/3pyh3JL
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Determining the best number of color clusters
\end_layout

\begin_layout Standard
The K-means algorithm was used to extract the dominant colors from the images.
 The Elbow method was used to calculate the optimal number of clusters to
 use in K-means.
 This method consists of iterating in a range of possible cluster numbers
 and determine the best one.
 We selected the pixel values of one processed image to train K-means.
 The range of 2 to 20 was declared to obtain the scores of K-means at each
 cluster number.
 Finally, we plotted these scores with their respective 
\shape italic
k
\shape default
 number.
 The number at the elbow in the plot indicates the best 
\shape italic
k
\shape default
 number of clusters, which is 4 for this experiment 
\shape italic
\emph on
(see Fig.
 
\shape default
\emph default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Elbow-method"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Elbow curve.png
	lyxscale 30
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Elbow method showing the optimal k number of clusters 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-Elbow-method"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Color extraction
\end_layout

\begin_layout Standard
In this step, the dominant colors are extracted from the rock images.
 In Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:get-dominant-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the 
\begin_inset Quotes eld
\end_inset

get_dominant_colors
\begin_inset Quotes erd
\end_inset

 function receives the pixel values of an image to train the K-means algorithm
 with 
\shape italic
k
\shape default
 clusters.
 In line 6, K-means works by separating the pixels of the image into 4 clusters
 of similarly colored pixels.
 The colors at each cluster center reflect the average value of the attributes
 of all members of a cluster.
 The percentage of a cluster is the number of pixels within that color cluster
 and is calculated in lines 8 to 10.
 Finally, the centroid of each cluster and its percentage are sorted in
 increasing order of percentage and added to a features list in lines 12
 to 17.
 The returned list in line 19 are the sixteen features: the four dominant
 colors represented by the three channels of the selected color format and
 the percentage of each dominant color (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Dominant-colors-and"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/get dominant colors.txt"
lstparams "language=Python,caption={Function to extract the dominant colors from a single image},label={list:get-dominant-colors}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Color extraction.png
	lyxscale 15
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Sample rocks with their dominant colors in percentage order and their average
 color
\begin_inset CommandInset label
LatexCommand label
name "fig:Dominant-colors-and"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:iterate-to-extract-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the processed data in RGB format is iterated in lines 4 to 6 and to extract
 the dominant colors in line 5 with the function of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:get-dominant-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The colors are added to a new list of extracted colors in line 6.
 This process is also made for the CIELAB data in lines 8 and 9.
 Finally, the extracted colors in RGB and CIELAB formats are saved together
 with their respective rock label in different CSV files.
 These files were used in the next step to train the machine learning algorithms.
 The CSVs with the extracted dominant colors in RGB and CIELAB color spaces
 are available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/colors_RGB.csv
\end_layout

\end_inset


\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/colors_LAB.csv
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/Iterate in data to extract colors.txt"
lstparams "language=Python,caption={Iterate original data to extract dominant colors},label={list:iterate-to-extract-colors}"

\end_inset


\end_layout

\begin_layout Subsection
Data normalization and label encoding
\end_layout

\begin_layout Standard
First, in this step we loaded the dominant colors data from the CSVs.
 The dominant colors and their percentage are the data features loaded into
 
\shape italic
x
\shape default
, and the rock classes are the data labels loaded into 
\shape italic
y
\shape default
.
 Second, in order to train and test the models, the 
\shape italic
x
\shape default
 and 
\shape italic
y
\shape default
 data were divided into a training set of 80% and a test set of 20% using
 the 
\begin_inset Quotes eld
\end_inset

train_test_split
\begin_inset Quotes erd
\end_inset

 function of the model_selection class from Scikit-learn.
 Thereafter, we normalized the 
\shape italic
x
\shape default
 data of train and test sets using the 
\begin_inset Quotes eld
\end_inset

MinMaxScaler
\begin_inset Quotes erd
\end_inset

 function imported from the preprocessing class of Scikit-learn.
 This function scales each feature to a given range of 0 to 1 for data cleaning
 and better performance in model training.
 Finally, we encoded the 
\shape italic
y
\shape default
 data in order to train the machine learning models transforming the labels
 into values from 0 to 3 representing the four rock classes of plutonic
 rocks: gabbro, diorite, granodiorite, and granite respectively.
 The encoding process was made with the 
\begin_inset Quotes eld
\end_inset

LabelEncoder
\begin_inset Quotes erd
\end_inset

 function of the preprocessing class imported from Scikit-learn module.
\end_layout

\begin_layout Subsection
Training the different algorithms with the extracted dominant colors
\end_layout

\begin_layout Standard
Five machine learning models were trained in this experiment using the RGB
 and afterwards the CIELAB dominant colors data: LR, KNN, DT, SVM, and a
 CNN.
 The notebook showing the code for training and validation of the generated
 models is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/ML-training.ipynb
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Listings 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-LR"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 present the set and training process of the models.
 The LR, KNN and CNN models were trained with the normalized data while
 the DT and SVM models with non-normalized data.
 The following configurations were used to set the models:
\end_layout

\begin_layout Standard
LR was created in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-LR"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the L-BFGS (Limited-memory Broyden–Fletcher–Goldfarb–Shanno) solver.
 L-BFGS is one of the quasi-Newton methods that approximate the BFGS algorithm
 which utilizes a limited amount of computer memory.
 The solver's methodology starts iterating at a random point (
\shape italic
xt
\shape default
) to calculate the minimum from the second derivate of the original function
 at that point and assign it to a new point (xt+1).
 The new point will become the starting point for the next iteration.
 In this way, L-BFGS quickly converges on the solution 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train LR.txt"
lstparams "language=Python,caption={Configuration and training of LR},label={list:train-LR}"

\end_inset


\end_layout

\begin_layout Standard
The number of neighbors used for KNN in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-KNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 represents the neighbor samples analyzed from the dataset to classify a
 new sample into the class to which most of their neighbors belong.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train KNN.txt"
lstparams "language=Python,caption={Configuration and training of KNN},label={list:train-KNN}"

\end_inset


\end_layout

\begin_layout Standard
By using class weights, we can increase the importance of a particular class
 during training.
 DT is created in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-DT"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the balanced mode for class weight.
 This mode uses the label values of the training set to automatically adjust
 the node weights inversely proportional to the class frequencies in the
 input data 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train DT.txt"
lstparams "language=Python,caption={Configuration and training of DT},label={list:train-DT}"

\end_inset


\end_layout

\begin_layout Standard
SVM is created in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-SVM"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the Radial Basis Function (RBF) kernel which is useful to eliminate
 the computational requirement of the algorithm.
 When training an SVM with RBF, the parameter gamma must be considered.
 It defines how much influence a single training sample has.
 The larger gamma is, the closer other examples must be to be affected.
 The auto gamma value in Scikit-learn is represented by 
\begin_inset Formula $1/number\ of\ features$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Buitinck2013"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train SVM.txt"
lstparams "language=Python,caption={Configuration and training of SVM},label={list:train-SVM}"

\end_inset


\end_layout

\begin_layout Standard
The proposed CNN model is a four-layer structure: two one-dimensional convolutio
nal layers and two fully-connected layers.
 There is a maxpooling layer after each convolutional layer.
 Also a flatten layer is placed after the last maxpooling layer.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:CNN-model-structure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 describes the CNN model structure created in Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
CNN model structure 
\begin_inset CommandInset label
LatexCommand label
name "tab:CNN-model-structure"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="6.8em">
<column alignment="center" valignment="middle" width="3.2em">
<column alignment="center" valignment="middle" width="3.4em">
<column alignment="center" valignment="middle" width="4.7em">
<column alignment="center" valignment="middle" width="4.5em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Layer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Filters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kernel size
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Activation function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output shape
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Input features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conv1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MaxPooling1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conv1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8 × 64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MaxPooling1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4 × 64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flatten
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
256
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dense
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dense
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Softmax
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In line 7 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 the sequential model of the Keras
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://keras.io
\end_layout

\end_inset

 library from Tensorflow was defined.
 This model is formed by layers where each layer has exactly one input tensor
 and one output tensor.
 In lines 8 and 10 two convolutional layers of one dimension were added
 to the model using RELU as their activation function, 2 as kernel size,
 and a total of 32 and 64 filters respectively.
 This kind of layer creates a convolution kernel that is convolved with
 the input layer to produce a output tensor of the filters dimension.
 Moreover, Rectified Linear Unit (RELU) activation function is used to achieve
 non-linearity converting the negative values of the output tensor to 0
 after convolution operation 
\begin_inset CommandInset citation
LatexCommand citep
key "Mitchell2019"
literal "false"

\end_inset

.
 In lines 9 and 11 the maxpooling layers are added with a size of 2 after
 each convolutional layer.
 Maxpooling layer downsamples the input by taking the maximum value over
 a window defined by pool size.
 In line 12 the flatten layer flattens the input to one dimension.
 In lines 13 and 14 two fully connected layers are added with 64 and 4 filters
 using RELU and Softmax activation functions respectively.
 The Softmax function is generally used in the output layer to normalize
 a vector containing 
\shape italic
k
\shape default
 elements into a probability distribution over the 
\shape italic
k
\shape default
 elements.
 In this case, the last layer output contains the probabilities of the four
 rock classes 
\begin_inset CommandInset citation
LatexCommand citep
key "Dawani2020"
literal "false"

\end_inset

.
 In line 15, the model was compiled with the categorical cross-entropy loss
 function and the Adam optimizer.
 Categorical cross-entropy is the most diffused classification cost function,
 adopted by LR and the majority of CNN architectures.
 This convex function is an excellent choice for classification problems
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonaccorso2018"
literal "false"

\end_inset

.
 On the other hand, Adam (adaptive moment estimation) algorithm is an efficient
 method to optimize the weights of a model computing the adaptive learning
 rates for each parameter 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
 Finally, to train the CNN several numbers of epochs and batches were tried
 until the most optimal values were obtained as shown in line 19.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train CNN.txt"
lstparams "language=Python,caption={Configuration and training of CNN},label={list:train-CNN}"

\end_inset


\end_layout

\begin_layout Subsection
Creation of the iOS application
\end_layout

\begin_layout Standard
The best model was deployed in an iOS mobile application to make the classificat
ion of images of four classes of plutonic rocks in real time.
 The source code of the application is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Rock-Classifer-iOS
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
The main requirements to develop the application were the Xcode IDE, the
 Xcode command-line tools, a valid Apple Developer ID, and the CocoaPods
 dependency manager.
 The application is written mostly in Swift and uses the following two libraries
 to perform the extraction of the dominant colors and the rock image classificat
ion:
\end_layout

\begin_layout Itemize
The DominantColor
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/indragiek/DominantColor
\end_layout

\end_inset

 dependency is an open source library written in Swift and created by Indragie
 Karunaratne.
 It finds the dominant colors of an image using the K-means clustering algorithm.
 In this project an adaptation of this library was implemented exporting
 code from the 7 main files of the repository into the application project.
\end_layout

\begin_layout Itemize
The TensorFlowLite Swift
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/swift
\end_layout

\end_inset

 library is TensorFlow's lightweight solution for Swift developers.
 It enables low-latency inference of on-device machine learning models with
 a small binary size and fast performance supporting hardware acceleration.
 For the application, TensorFlowLiteSwift pod name was added into the project's
 Podfile, and from command line the library was resolved into the Xcode
 project by the CocoaPods dependency manager.
\end_layout

\begin_layout Standard
In order to deploy a machine learning model in the application, we exported
 the best model by creating a concrete function in TensorFlow using the
 training set of dominant colors.
 This function calculates the Manhattan distance between a new sample and
 all the points in the training data to assign the label of the nearest
 point to the new point.
 The last step in the model exportation was to export the graph of the concrete
 function in a 
\begin_inset Quotes eld
\end_inset

tflite
\begin_inset Quotes erd
\end_inset

 file using TensorFlow Lite.
 The source code of the creation and exportation of the model in TensorFlow
 is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/ML-training.ipynb
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Results and Discussion
\end_layout

\begin_layout Subsection
Results
\end_layout

\begin_layout Standard
The following metrics were used in this project to evaluate the models.
 According to 
\begin_inset CommandInset citation
LatexCommand citep
key "Galeone2019"
literal "false"

\end_inset

:
\end_layout

\begin_layout Itemize
Accuracy is the ratio of the number of correct predictions made to the number
 of all predictions made.
\begin_inset Formula 
\[
Accuracy=\frac{Correct\ Predictions}{Predictions\ Made}
\]

\end_inset


\end_layout

\begin_layout Itemize
Precision is the number of correct positives results, divided by the number
 of positive results predicted.
\begin_inset Formula 
\[
Precision=\frac{TP}{TP+FP}
\]

\end_inset


\end_layout

\begin_layout Itemize
Recall is the number of correct positive results, divided by the number
 of all the samples that should be classified as positive.
\begin_inset Formula 
\[
Recall=\frac{TP}{TP+FN}
\]

\end_inset


\end_layout

\begin_layout Itemize
F1-score is the harmonic mean between precision and recall.
 The greater the F1 score, the better the overall performance of the model.
\begin_inset Formula 
\[
F1=2*\frac{Precision*Recall}{Precision+Recall}
\]

\end_inset


\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Models-results"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the average accuracy, precision, recall, and F1-score results of
 each model evaluated with the test sets of dominant colors in RGB and CIELAB
 color formats.
 The models generated with the KNN, SVM, LR, and CNN algorithms gave better
 results for CIELAB than RGB data.
 DT results were better in RGB.
 The best results were for the KNN model using the CIELAB dominant colors
 data with an accuracy, precision, recall, and F1-score of 93%.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of the models in terms of accuracy, precision, recall, and F1-score
\begin_inset CommandInset label
LatexCommand label
name "tab:Models-results"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="4em">
<column alignment="center" valignment="middle" width="4em">
<column alignment="center" valignment="middle" width="4em">
<column alignment="center" valignment="middle" width="4em">
<column alignment="center" valignment="middle" width="4em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Accuracy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
with CIELAB dominant colors
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
LR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.63
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.66
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.63
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
KNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
DT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.72
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
SVM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.80
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.82
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
with RGB dominant colors
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
LR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.63
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.65
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.62
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
KNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
DT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.74
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
SVM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.52
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.49
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.46
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.70
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement t
wide true
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Workflow.png
	lyxscale 50
	width 85page%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Application workflow 
\begin_inset CommandInset label
LatexCommand label
name "fig:Application-workflow"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:KNN-results"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the evaluation results of the KNN model for each rock class in terms
 of precision, recall, and F1-score using the CIELAB dominant colors data.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of KNN for each rock class
\begin_inset CommandInset label
LatexCommand label
name "tab:KNN-results"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="6em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.96
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.94
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.85
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.96
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The KNN model was deployed on the iOS application (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Application-workflow"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 There are two ways to make the classification of new rocks on this application.
 The first way is taking a picture with the 
\begin_inset Quotes eld
\end_inset

Open Camera
\begin_inset Quotes erd
\end_inset

 button shown in step 1A of figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Application-workflow"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 When camera opens, the new scene of step 2A appears and displays the device
 camera.
 The second way is choosing a photo from the 
\begin_inset Quotes eld
\end_inset

Photo Library
\begin_inset Quotes erd
\end_inset

.
 The 
\begin_inset Quotes eld
\end_inset

Open Library
\begin_inset Quotes erd
\end_inset

 button in step 1B opens the photo library of the device as shown in step
 2B.
 The extraction of the dominant colors is performed after the image was
 loaded with the 
\begin_inset Quotes eld
\end_inset

dominantColorsInImage
\begin_inset Quotes erd
\end_inset

 function.
 Thereafter, the 
\begin_inset Quotes eld
\end_inset

Classify
\begin_inset Quotes erd
\end_inset

 button in step 3 is enabled to classify the new rock image into: gabbro,
 diorite, granodiorite, or granite.
 When the button is pressed the extracted colors are converted to CIELAB
 and sorted in ascending order by their percentage of pixels in the image.
 These colors and their percentage are used as the input tensor for the
 model imported from the 
\begin_inset Quotes eld
\end_inset

tflite
\begin_inset Quotes erd
\end_inset

 file containing its graph.
 Optionally, the dominant colors and the average colors of the selected
 image can be displayed pressing the 
\begin_inset Quotes eld
\end_inset

Extracted
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Average
\begin_inset Quotes erd
\end_inset

 buttons of steps 4A and 4B respectively.
\end_layout

\begin_layout Subsection
Discussion
\end_layout

\begin_layout Standard
Five machine learning algorithms were trained with just the four dominant
 colors extracted from images of plutonic rocks.
 The best algorithm in this experiment was K-Nearest Neighbors trained with
 the dominant colors in the CIELAB color format of 283 images.
 Its values of accuracy, precision, recall, and F1-score average were equal
 to 93%.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Comparison-of-the"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the comparison of these results and the results of the CNN of
 our previous work [ref] that used all the image features.
 Although the results of our previous work were 2% better in terms of accuracy,
 recall, and f1-score, and 3% in precision, it is noteworthy that this dominant
 colors approach did not apply data augmentation technique to image data
 as in our previous work.
 Furthermore, a training time of 0.068 s, an execution time of 339.87 ms,
 and a file size of 0.018 MB were obtained in this work compared with
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 2 hrs, 353.74 ms, and 2.6 MB of 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
our previous work
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
.
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
These computational metrics were better with the dominant colors approach
 being the training and execution times were 96% and 4% faster than in our
 previous work, and the file size was 99.3% lighter.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of the average accuracies of this research with our previous
 work
\begin_inset CommandInset label
LatexCommand label
name "tab:Comparison-of-the"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="middle" width="6.4em">
<column alignment="center" valignment="middle" width="8.8em">
<column alignment="center" valignment="middle" width="11em">
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Metrics
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
KNN of this work with four dominant colors
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
CNN of our previous work [ref] with all the features used during training
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Accuracy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
96%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
F1-score
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Training time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.33 min
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
120 min
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Execution time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
339.87 ms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
353.74 ms
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
File size
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018 MB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.6 MB
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The dominant color approach is very useful in terms of processing time and
 memory being much faster than other models presented in the related work
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Feature extraction serves the function of detecting and separating fundamental
 parts of digital images.
 Moreover, it simplifies a complex input dataset into a set of features
 in a reduced order
\end_layout

\begin_layout Plain Layout
ISSN: 2278-0181
\end_layout

\end_inset

.
 Feature reduction can be applied when it is necessary to reduce the memory
 and execution time of a model.
 In addition, CIELAB color format is an excellent option for classifications
 where color is important to differentiate images.
\end_layout

\begin_layout Standard
Future improvements to this work can be made increasing our dataset with
 images taken under different conditions in which the rock could be found
 (such as angles, distance, light, shadows, weathering, vegetation and others).
 Furthermore, another important low-level feature in the classification
 of plutonic rocks is the shapes of their crystals.
 Adding this feature using transfer learning before train the machine learning
 algorithms can improve the results.
 Finally, adding more rock types to our dataset also could improve the classific
ation of plutonic rocks allowing the model to distinguish the most characteristi
c shadows and colors of each type.
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
I think we should add a sub-section at the end of the Results section, to
 explain the limitations/bias of our approach.
 For example, the way the picture was taken, the amount of light interacting
 with the rock/outcrop, the weathering/alteration/oxidation of the sample…these
 features will limit the accuracy of the recognition of color/shade in the
 rock.
 You got a comment about this from a reviewer of the paper submitted to
 Applied Computing and Geosciences and Ben and I will work on addressing
 these concerns.
 Basically, it is required to use pictures of rocks taken under good light
 settings, avoid taking pictures of samples with evidence of weathering
 or cover by vegetation… these details or directions need to be provided
 to the user of the app in order to get good results.
\end_layout

\begin_layout Plain Layout
....
\end_layout

\begin_layout Plain Layout
In future work, the datasets for training and validation will be extended
 with a larger number of plutonic rock images taken in the field, not in
 the lab, under different conditions (e.g., different distances, angles, lighting
 effects – blue vs.
 cloudy sky, weathering or alteration, shadows, vegetation, and moss).
 Also, a larger dataset will allow to avoid the process of image data augmentati
on in the validation dataset to count on two completely different datasets
 for training and validation.
 In addition, we are planning to obtain images for other classes of plutonic
 rocks.
 With the larger dataset, we expect to extend our mobile application with
 a new classification model able to classify rocks for a wide range of classes.
 Moreover, the results of the classification model will be compared with
 other convolutional neural networks.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "Code/Rocks"

\end_inset


\end_layout

\end_body
\end_document
