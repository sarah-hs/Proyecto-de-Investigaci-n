#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass IEEEtran
\begin_preamble
% for subfigures/subtables
\usepackage{titlesec}
\titlespacing{\subsubsection}{0pt}{0.6em}{0pt}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{diagbox}
\usepackage{array}
\usepackage{listings}
\lstdefinelanguage{Swift}{language=bash,morekeywords={fix},}
\usepackage{color}
\definecolor{lightgray}{RGB}{246,246,246}
\definecolor{darkgray}{RGB}{128,128,128}
\end_preamble
\options journal
\use_default_options false
\begin_modules
graphicboxes
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding ascii
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "Your Title"
\pdf_author "Your Name"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle false
\pdf_quoted_options "pdfpagelayout=OneColumn, pdfnewwindow=true, pdfstartview=XYZ, plainpages=false"
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine biblatex-natbib
\cite_engine_type numerical
\biblio_style jurabib
\biblatex_bibstyle ieee
\biblatex_citestyle numeric
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 2
\papersides 1
\paperpagestyle default
\listings_params "breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\scriptsize\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\scriptsize\ttfamily},xleftmargin={0.7cm},framexleftmargin={0.7em},numbersep=8pt,tabsize=3,backgroundcolor={\color{lightgray}},commentstyle={\color{darkgray}}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align left
\begin_inset Graphics
	filename Images/Logo_UM.png
	lyxscale 7
	width 2.5cm
	height 2.5cm
	keepAspectRatio

\end_inset


\begin_inset space \hspace{}
\length 12cm
\end_inset


\begin_inset Graphics
	filename Images/Logo_FIT.png
	lyxscale 75
	width 2.5cm
	height 2.5cm
	keepAspectRatio

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size huge
Universidad de Montemorelos
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 0.8cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Facultad de Ingeniería y Tecnología
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Ingeniería en Sistemas Computacionales
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size huge
Automatic Classification of Plutonic Rocks with Machine Learning applied
 to Extracted Shades and Colors on iOS Devices
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
\size huge
For our purposes this seems to be the important variable.
 Perhaps the term “brightness” should be used instead of the term “shade”
 ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Sarah Hernández Serrano
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
1170469
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Asesor: Dr.
 Germán Harvey Alférez Salinas
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Asesores secundarios: Dr.
 Benjamin Clausen y Dra.
 Ana María Martínez Ardila
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Montemorelos, Nuevo León, México
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
00 de mayo de 2021
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 7cm
\end_inset


\end_layout

\begin_layout Abstract
Plutonic rocks are formed when magma cools and solidifies below the Earth’s
 surface.
 Lightness and color are properties used for the classification of plutonic
 rocks; however, these attributes can be difficult to describe because perceived
 rock colors depend on the observer’s experience.
 Moreover, although the classification of plutonic rocks can be done using
 data from various instrumental techniques, these approaches tend to be
 expensive and time-consuming.
 We use pictures of plutonic rocks that had been classified using petrography
 and chemistry data.
 This research extracts dominant shades and colors from plutonic rock images
 to train several machine learning algorithms and deploy the best model
 on an iOS app for the automatic classification of four classes of plutonic
 rocks in order from darker to lighter: gabbro, diorite, granodiorite, and
 granite.
 First, the dominant colors of plutonic rock images were extracted with
 the K-means algorithm by grouping the image pixels according to the RGB
 and CIELAB color spaces.
 Then, the data of the four dominant colors were used to create and evaluate
 several machine learning models with the following algorithms: Logistic
 Regression (LR), K-Nearest Neighbors (KNN), Decision Trees (DT), Support
 Vector Machine (SVM), and a Convolutional Neural Network (CNN).
 The experiments were executed first with the dominant colors in RGB and
 then in CIELAB.
 Afterwards, the best model in terms of accuracy, precision, recall and
 F1-score was deployed after validation on an iOS application that classifies
 the extracted colors in new images of the four rock types.
 The best results during validation were for the model generated using KNN
 trained with 283 images in the CIELAB color space.
 Results gave accuracy, precision, recall, and F-score average values of
 93%.
 The application running the KNN model was tested in the field with 34 images,
 and the following average accuracy results were obtained: 85.7% for granite,
 20% for granodiorite, 28.5% for diorite, and 70% for gabbro.
 Finally, we compared the results in the field with our previous work in
 which a CNN was trained using all the image features of the same dataset
 of plutonic rocks and deployed on an Android application.
\end_layout

\begin_layout Keywords
Machine Learning, Color Extraction, iOS Devices, Geology, Rock Classification,
 Features Reduction, Dominant Colors, K-means Clustering, Logistic Regression,
 K-Nearest Neighbors, Support Vector Machine, Convolutional Neural Network,
 Decision Trees.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Title
Automatic Classification of Plutonic Rocks with Machine Learning applied
 to Extracted Shades and Colors on iOS Devices
\end_layout

\begin_layout Author
Sarah
\begin_inset space ~
\end_inset

Hernández,
\begin_inset space ~
\end_inset

Germán
\begin_inset space ~
\end_inset

H.
\begin_inset space ~
\end_inset

Alférez,
\begin_inset space ~
\end_inset

Benjamin
\begin_inset space ~
\end_inset

Clausen,
\begin_inset space ~
\end_inset

and
\begin_inset space ~
\end_inset

Ana
\begin_inset space ~
\end_inset

M.
\begin_inset space ~
\end_inset

Martínez 
\begin_inset Foot
status open

\begin_layout Plain Layout
Sarah
\begin_inset space ~
\end_inset

Hernández is a computer science engineering student at the School of Engineering
 and Technology of Montemorelos University, Montemorelos, Nuevo León, Mexico,
 e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "1170469@alumno.um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Germán H.
 Alferez, Ph.D., is the director of the Institute of Data Science and professor
 at the School of Engineering and Technology of Montemorelos University,
 Montemorelos, Nuevo León, Mexico, e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "harveyalferez@um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Benjamin Clausen, Ph.D., is a professor at the Department of Earth and Biological
 Sciences and at the Geoscience Research Institute, Loma Linda University,
 Loma Linda, California, USA, e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "bclausen@llu.edu"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Ana M.
 Martínez, Ph.D., is a professor at the Department of Earth and Biological
 Sciences of Loma Linda University, Loma Linda, California, USA, e-mail:
 
\begin_inset CommandInset href
LatexCommand href
target "anmartinez@llu.edu"
literal "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Special Paper Notice
School of Engineering and Technology, Montemorelos University, Mexico
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Subsection
Background
\end_layout

\begin_layout Standard
\begin_inset Flex Paragraph Start
status open

\begin_layout Plain Layout
\begin_inset Argument 1
status open

\begin_layout Plain Layout
P
\end_layout

\end_inset


\end_layout

\end_inset

lutonic rocks are formed when magma cools and solidifies below the Earth’s
 surface.
 Lightness and color are properties used for the classification of plutonic
 rocks.
 Color changes in rocks may indicate changes in the rock’s mineral assemblage,
 texture, organic carbon content (shales), or other properties 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
 That is why color is a key property for rock classification.
\end_layout

\begin_layout Standard
Our contribution is fourfold.
 First we used pictures of plutonic rocks that had been classified using
 petrography and chemistry data.
 The dominant colors of plutonic rock images were extracted with the K-means
 algorithm by grouping the image pixels according to the RGB (Red, Green,
 Blue) and CIELAB (or LAB) color spaces.
 Second, the data of the four dominant colors were used to create and evaluate
 several machine learning models for the automatic classification of four
 classes of plutonic rocks in order from darker to lighter: gabbro, diorite,
 granodiorite, and granite.
 The models were generated with the following algorithms: Logistic Regression
 (LR), K-Nearest Neighbors (KNN), Decision Trees (DT), Support Vector Machine
 (SVM), and a Convolutional Neural Network (CNN).
 Third, the best model in terms of accuracy, precision, recall and F-score
 was deployed after validation on an iOS application that classifies the
 extracted colors in new images of the four rock types obtaining the following
 accuracy results in the field: 85.7% for granite, 20% for granodiorite,
 28.5% for diorite, and 70% for gabbro.
 Fourth, we compared our approach with our previous work [ref] in which
 a CNN was trained with the same dataset of plutonic rock using the whole
 set of image pixel features instead of the four dominant colors.
\end_layout

\begin_layout Subsection
Problem Statement
\end_layout

\begin_layout Standard
The instruments for accurate rock classification are expensive making it
 prohibitive for geology students and amateurs.
 In addition, there is a lack of mobile tools for plutonic rock classification
 in the field using machine learning.
 Moreover, despite the fact that shade and color are significant properties
 for rock classification, these attributes are difficult to describe because
 perceived shades and colors in rocks depend on the observer's experience
 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Justification
\end_layout

\begin_layout Standard
There are two reasons to create an iOS mobile application that allows the
 classification of plutonic rocks with machine learning using their dominant
 colors.
 The dominant colors represent the principal color values of all the pixels
 in an image.
 First, no such application exists.
 A mobile application could offer the flexibility to carry out the classificatio
n in real time and could be an alternative to expensive traditional methods
 of rock classification.
 Second, in our previous work [ref] in which a CNN was deployed on an Android
 application, we found that the accuracy of the model using all the rock
 image features decreased when classifications are carried out in the field.
 In this research work we extracted the dominant colors to verify if feature
 reduction leads to better results in the field than that obtained in our
 previous work.
\end_layout

\begin_layout Subsection
Objectives
\end_layout

\begin_layout Standard
The main objective of this research work is to extract dominant colors from
 plutonic rock images to train several machine learning algorithms and deploy
 the best model in an iOS app.
 The results in the field are compared with our previous work [ref].
 This objective is achieved with the following sub-objectives:
\end_layout

\begin_layout Itemize
Determine the best 
\shape italic
k
\shape default
 number of clusters to use in the K-means clustering machine learning method
 to extract the dominant colors in terms of RGB and CIELAB color spaces
 from 283 images of plutonic rocks.
\end_layout

\begin_layout Itemize
Use the extracted dominant colors and the percentage of pixels belonging
 to each color cluster as the input to train the following machine learning
 algorithms: LR, KNN, DT, SVM, and CNN.
\end_layout

\begin_layout Itemize
Validate the models generated by means of the accuracy, precision and recall
 metrics.
 The best model is deployed in an iOS mobile application.
 
\end_layout

\begin_layout Itemize
Test the effectiveness of the application with images taken from new plutonic
 rocks of gabbro, diorite, granodiorite, and granite in the field.
 The results are compared with our previous work in which a CNN was trained
 with images using the whole set of features.
 
\end_layout

\begin_layout Subsection
Hypothesis
\end_layout

\begin_layout Standard
A machine learning model trained with just the dominant colors extracted
 from gabbro, diorite, granodiorite, and granite images can provide an effective
 way to classify these plutonic rocks.
\end_layout

\begin_layout Section
Theoretical Foundation
\end_layout

\begin_layout Subsection
Underpinnings of our Approach
\end_layout

\begin_layout Standard
Our approach is based on the following concepts 
\shape italic
\emph on
(see Fig.
 
\shape default
\emph default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Underpinnings-of-our"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Map of concepts.png
	lyxscale 20
	width 100col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Underpinnings of our approach 
\begin_inset CommandInset label
LatexCommand label
name "fig:Underpinnings-of-our"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Plutonic rocks
\end_layout

\begin_layout Standard
Plutonic rocks crystalize inside the Earth’s crust from magma are generally
 coarse-grained and compositionally classified by the proportion of minerals
 in it.
 According to 
\begin_inset CommandInset citation
LatexCommand citep
key "RACEFEN-gg"
literal "false"

\end_inset

:
\end_layout

\begin_layout Itemize
Gabbro is a plutonic rock composed mainly of calcium plagioclase and pyroxene,
 with or without olivine or amphibole.
 It is the intrusive equivalent of basalt and is distinguished from diorite
 by the nature of plagioclase, which is higher in calcium than in sodium.
\end_layout

\begin_layout Itemize
Diorite has about the same structural properties as granite but darker color
 and more limited occurrence.
 Commonly it is composed of about two-thirds plagioclase feldspar and one-third
 dark-coloured minerals, such as hornblende or biotite.
 The presence of more sodium-rich plagioclase and less calcium-rich plagioclase
 is the main distinction between diorite and gabbro 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Diorite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Granodiorite is characterized by quartz with plagioclase constituting more
 than 2/3 of the total feldspars.
 Generally, together with granite, it is the most abundant rock of the great
 batholiths.
 Its volcanic equivalent is dacite.
 Granodiorite is similar to granite, but with less potassium feldspar and
 more plagioclase, hornblende, and biotite.
\end_layout

\begin_layout Itemize
Granite is a light-colored rock characterized by coarse to medium crystal
 size, composed of approximately equal amounts of quartz, potassium feldspar,
 and plagioclase as essential minerals, and smaller amounts of other minerals,
 such as biotite, muscovite or hornblende.
\end_layout

\begin_layout Subsubsection
Machine Learning
\end_layout

\begin_layout Standard
Machine learning is a branch of artificial intelligence that lies at the
 intersection between computer science, engineering and statistics, and
 often appears in other disciplines.
 Machine learning systems can be classified according to the type of supervision
 they get during training 
\begin_inset CommandInset citation
LatexCommand citep
key "Harrington2012,Geron2019"
literal "false"

\end_inset

.
 In this way, there are two major categories:
\end_layout

\begin_layout Paragraph
Supervised learning
\end_layout

\begin_layout Standard
In supervised learning, the training set fed to the algorithm includes the
 desired solutions, called labels.
 A typical supervised learning task is classification 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
 Some common algorithms of supervised learning are described as follows:
\end_layout

\begin_layout Itemize
Logistic Regression (LR) is commonly used to estimate the probability that
 an instance belongs to a particular class.
 This model computes a weighted sum of the input features (plus a bias term)
 and outputs the logistic of this result.
 The logistic is a sigmoid function that outputs a number between 0 and
 1.
 This makes it a binary classifier 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
K-Nearest Neighbors (KNN) is a simple algorithm used to find a predefined
 number of training samples closest in distance to the new point, and predict
 the label from these.
 Being a non-parametric method, it is often successful in classification
 situations where the decision boundary is very irregular 
\begin_inset CommandInset citation
LatexCommand citep
key "sklearn-KNN"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Decision Trees (DT) algorithm consists of split nodes and leaf nodes.
 Each split node performs a split decision and routes a data sample either
 to the left or the right child node.
 In the tree structures, leaves represent the labels, non-leaf nodes are
 the input features, and branches represent conjunctions of features that
 lead to the classifications 
\begin_inset CommandInset citation
LatexCommand citep
key "REINDERS201965,TAN2015493"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Support Vector Machine (SVM) algorithm is a powerful and versatile machine
 learning model, particularly well suited for classification of complex
 small- or medium-sized datasets.
 In this algorithm, the data is plotted in a n-dimensional space (number
 of features) and a decision boundary (hyperplane) splits it into classes
 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019,Harrington2012"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Convolutional Neural Networks (CNNs) emerged from the study of the brain’s
 visual cortex.
 The most important building block is the convolutional layer.
 The CNN´s architecture consists of several connected layers allowing the
 network to concentrate on small low-level features in the first hidden
 layer, then assemble them into larger higher-level features in the next
 layer, and so on 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Unsupervised learning
\end_layout

\begin_layout Standard
In unsupervised learning the training data is unlabeled.
 One of the most important unsupervised learning algorithms is K-means.
 K-means is a simple algorithm capable of clustering an unlabeled dataset
 very quickly and efficiently, often in just a few iterations.
 Its goal is to group similar instances together into clusters.
 The number of 
\shape italic
k 
\shape default
clusters that the algorithm must find is specified to easily assign each
 instance to one of the 
\shape italic
k
\shape default
 clusters 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Dominant colors
\end_layout

\begin_layout Standard
The dominant colors refer to the principal colors presented in an image.
 The dominant colors of an image are selected grouping the image pixels
 according to their color in the selected color space (RGB or CIELAB).
 The average color of each group are the dominant colors and the number
 of pixels of that groups are the percentage of the dominant colors.
\end_layout

\begin_layout Standard
In RGB (Red, Green, Blue), the light spectra of varying fractions of the
 three primary colors referred to as channels, combine to make new colors.
 Each channel has intensity values from 0 to 1 that are scaled by the number
 of bits used to represent each component.
 The 24-bit color cube used in this research has components in the range
 of 0–255.
 Each color in the color space can be represented as a three-value vector
 
\begin_inset CommandInset citation
LatexCommand citep
key "Wallace2002"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
On the other hand, CIELAB has the property of being perceptually uniform
 (useful to measure the similarity between two given colors) and is designed
 to approximate human vision.
 The L channel which represents the brightness of each pixel varies between
 0 and 100.
 The 
\shape italic
a
\shape default
 (red/green) and 
\shape italic
b
\shape default
 (yellow/blue) channels which correspond to the chromaticity components
 contain information about the color of a pixel, independent of its brightness.
 Their values vary between -127 and 127 
\begin_inset CommandInset citation
LatexCommand citep
key "DavidMillanEscriva2019,Young2009"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Underlying technologies
\end_layout

\begin_layout Paragraph
Scikit-learn
\end_layout

\begin_layout Standard
Scikit-learn is a Python module that integrates a wide range of state-of-the-art
 machine learning algorithms for medium-scale supervised and unsupervised
 problems.
 This library focuses on bringing machine learning to non-specialists using
 a general-purpose high-level language.
 Emphasis is put on ease of use, performance, documentation, and API consistency.
 It has minimal dependencies and is distributed under the simplified Berkeley
 Source Distribution (BSD) license, encouraging its use in both academic
 and commercial settings 
\begin_inset CommandInset citation
LatexCommand citep
key "scikit-learn"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow
\end_layout

\begin_layout Standard
TensorFlow
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://www.tensorflow.org
\end_layout

\end_inset

 is an interface for expressing machine learning algorithms and an implementatio
n for executing such algorithms.
 A computation expressed using TensorFlow can be executed with little or
 no change on a wide variety of heterogeneous systems, ranging from mobile
 devices such as phones and tablets up to large-scale distributed systems
 with hundreds of machines and thousands of computational devices such as
 GPU cards 
\begin_inset CommandInset citation
LatexCommand citep
key "Abadi2016"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow Lite
\end_layout

\begin_layout Standard
TensorFlow Lite
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://www.tensorflow.org/lite
\end_layout

\end_inset

 is a set of tools to help developers run TensorFlow models on mobile, embedded,
 and IoT devices.
 It enables on-device machine learning inference with low latency and a
 small binary size 
\begin_inset CommandInset citation
LatexCommand citep
key "TF-TFLite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
TensorFlow Lite consists of two main components:
\end_layout

\begin_layout Itemize
The TensorFlow Lite interpreter, which runs specially optimized models on
 many different hardware types, including mobile phones, embedded Linux
 devices, and microcontrollers.
\end_layout

\begin_layout Itemize
The TensorFlow Lite converter, which converts TensorFlow models into an
 efficient form for use by the interpreter, and can introduce optimizations
 to improve binary size and performance.
\end_layout

\begin_layout Paragraph
Swift
\end_layout

\begin_layout Standard
Swift
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://swift.org
\end_layout

\end_inset

 is an open source programming language designed for macOS, iOS, watchOS,
 tvOS, and more.
 Swift already supports all Apple platforms and Linux, with community members
 actively working to port to even more platforms 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Swift"
literal "false"

\end_inset

.
 In 2010, Apple started developing Swift, a new programming language that
 would rival Objective-C in type safety, security, and hardware performance.
 Swift is more than 2.6x faster than Objective-C and more than 8.4x faster
 than Python 
\begin_inset CommandInset citation
LatexCommand citep
key "TechRep-Swift"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Xcode
\end_layout

\begin_layout Standard
Xcode
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://developer.apple.com/xcode/
\end_layout

\end_inset

 is a long-standing tool for app production and a well-known integrated
 development environment (IDE), enabling developers to write the code and
 compile apps that can be used on a variety of different devices and operating
 systems 
\begin_inset CommandInset citation
LatexCommand citep
key "AInsider-Xcode"
literal "false"

\end_inset

.
 It also includes a unified macOS SDK and all the frameworks, compilers,
 debuggers, and other tools necessary to build applications that run natively
 on Apple devices 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Xcode"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
CocoaPods
\end_layout

\begin_layout Standard
CocoaPods
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://cocoapods.org
\end_layout

\end_inset

 is a dependency manager for Swift and Objective-C Cocoa projects.
 The dependencies of the projects are just specified in a single text file
 called a Pod file.
 CocoaPods resolves dependencies between libraries, fetches the resulting
 source code, then links it together in an Xcode workspace to build a single
 project 
\begin_inset CommandInset citation
LatexCommand citep
key "CocoaPods"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Related Work
\end_layout

\begin_layout Standard
\begin_inset Float table
placement !t
wide true
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison table of the articles described in the related work 
\begin_inset CommandInset label
LatexCommand label
name "tab:Related-work-comparison"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="9">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="4em">
<column alignment="center" valignment="middle" width="2.5em">
<column alignment="center" valignment="middle" width="8.8em">
<column alignment="center" valignment="middle" width="6.3em">
<column alignment="center" valignment="middle" width="8.3em">
<column alignment="center" valignment="middle" width="4.4em">
<column alignment="center" valignment="middle" width="4.6em">
<column alignment="center" valignment="middle" width="4.8em">
<column alignment="center" valignment="middle" width="7.2em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Author
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Year
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dataset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Algorithm of extraction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dataset for training
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Best trained model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Results
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Resuts in the field
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E.
 Vázquez and H.
 Alférez [ref]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2021
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
846 patches from 71 images of six plutonic rock types (gabbro, diorite,
 tonalite, monzodiorite, granodiorite, and granite)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50% of the patches
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-layer structure CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Accuracy: 95%
\end_layout

\begin_layout Plain Layout
Precision: 96%
\end_layout

\begin_layout Plain Layout
Recall: 95%
\end_layout

\begin_layout Plain Layout
F1-score: 95%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Android application accuracy results: 70% for gabbro, 28.5% for diorite,
 100% for granodiorite, and 28.5% for granite
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fan et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2020
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,208 images of 28 rock lithology categories
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SqueezeNet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 94.55%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Android application accuracy: 94.55%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fan et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020a"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2020
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,795 images of 30 different rock types
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ShuffleNet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 95.30%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Android application accuracy: 97.65%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ran et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14,589 patches from 2,290 images of six rock types (granite, limestone,
 conglomerate, sandstone, shale, mylonite)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60% of the patches
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3-layer structure CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 97.76%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Zhang et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell mroffset="10cm" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
481 images of four minerals (K-feldspar, perthite, plagioclase, and quartz)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Inception-v3 CNN model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
High-level features (such as chromatic aberration and texture)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
90% of extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stacking model (LR, SVM, and MLP)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 90.9%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maitre et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,192 sub-images of the views of a surface taken at different angles to
 a surface with 27 mineral grain species
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simple Linear Iterative Clustering (SLIC) algorithm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Color intensity and Peak intensity of computed histograms from superpixels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70% of extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random Forest (RF)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 89%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cheng and Guo 
\begin_inset CommandInset citation
LatexCommand citep
key "Cheng2017"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2017
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,200 images of three feldspar sandstone rock types (coarse, medium granular,
 and fine)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
75% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6-layer structure CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 98.5%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Over the last decade, there has been considerable progress in the application
 of machine learning to geochemistry 
\begin_inset CommandInset citation
LatexCommand citep
key "Lary2018"
literal "false"

\end_inset

.
 In this section we present relevant research work in three areas: image
 classification of rock lithology using machine learning, rock classification
 with machine learning on Android devices, and recognition of mineral images
 applying machine learning and feature extraction.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Related-work-comparison"
plural "false"
caps "false"
noprefix "false"

\end_inset

 summarizes the works presented in this section.
\end_layout

\begin_layout Subsubsection
Image classification of rock lithology using machine learning
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019"
literal "false"

\end_inset

, Ran et al.
 proposed a CNN model for the classification of six rock types (granite,
 limestone, conglomerate, sandstone, shale, mylonite) and compared their
 results with four other common machine learning models.
 A total of 2,290 images were labeled according to the clarity of the rock
 and cropped into 14,589 sample patches of 512 × 512 pixels compressed to
 128 × 128 pixels.
 60% of the patches of each type of rock were selected for the training
 dataset, 20% for the validation dataset, and 20% for the testing dataset.
 Their proposed CNN model achieved the highest overall accuracy of 97.76%
 compared with the other models: SVM, AlexNet, GoogleLeNet Inception v3,
 and VGGNet-16.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Cheng2017"
literal "false"

\end_inset

, Cheng and Guo proposed a deep CNN to identify the granularity of feldspar
 sandstone rocks in images under three color spaces: RGB, YCbCr, and HSV.
 A total of 4,200 images were collected from rocks of an oil field in Ordos
 and divided into three types of granularity: coarse, medium granular, and
 fine.
 The RGB images were normalized to 224 × 224 pixels and converted to YCbCr
 and HSV.
 The proposed CNN was a 6-layer structure of 4 convoluted layers with ReLU
 as the activation function and 2 fully connected layers with Softmax as
 the classifier.
 The model was trained for each color space with 75% of the experimental
 data, a batch size of 100, and different kernel sizes and learning rates.
 The lowest error rates were obtained with the learning rate of 0.0005, the
 kernel sizes of 11, 5, 3, and 3 for each convolutional layer respectively,
 and the cross-validation for HSV color space.
 In RGB color space, the classification accuracy achieved 98.5%.
\end_layout

\begin_layout Subsubsection
Rock classification with machine learning on Android devices
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020"
literal "false"

\end_inset

, Fan et al.
 created a method for rock lithology recognition on Android devices based
 on the two lightweight SqueezeNet and MobileNet CNNs.
 These models were compared with ResNet50, a heavyweight model.
 The images were selected from the China Geological Survey dataset that
 contains images of 28 rock categories taken by a smartphone camera.
 The 3,208 images were reduced to 214 × 214 pixels and the 80% were used
 to train the two CNNs pretrained with ImageNet dataset.
 The achieved occupation sizes were 19.6 MB and 36.8 MB for MobileNet and
 SqueezeNet, and 232.7 MB for ResNet50.
 SqueezeNet was almost two times faster than MobileNet, and 7 times faster
 than ResNet50.
 A rock recognition software based on the trained models was developed for
 Android devices.
 The results for SqueezeNet and MobileNet on Android smartphones were as
 follows: the file sizes of 9.2 MB and 17.6 MB, the execution time from 736
 to 366 and 1,218 to 523 milliseconds, and the recognition accuracies of
 94.55% and 93.27%.
\end_layout

\begin_layout Standard
Also in 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020a"
literal "false"

\end_inset

, Fan et al.
 improved their work using a model based on ShuffleNet for quick and accurate
 rock lithology recognition with smartphones and compared it with their
 previous work of MobileNet and SqueezeNet.
 They selected 3,795 images of 30 different kinds of rocks collected from
 multiple locations in East China.
 The ShuffleNet model was trained using 80% of the dataset, 3,600 iteration
 steps, a learning rate of 0.008, and the parameters imported by the transfer
 learning method using the ImageNet dataset.
 ShuffleNet occupied a space of 18.2 MB compared with MobileNet, SqueezeNet,
 and ResNet50 that occupied 34.5 MB, 25 MB, and 219.4 MB respectively.
 An Android application was created using each model and run on three Android
 smartphones (Huawei, Samsung, and Oppo).
 The average recognition time of ShuffleNet for a single rock image was
 786 milliseconds, the reached accuracy was 97.65% on PC and 95.30% on the
 smartphones.
\end_layout

\begin_layout Standard
In our previous work [ref], we proposed a CNN model trained with several
 combinations of plutonic rocks to deploy the best combination of rocks
 in an Android application.
 The dataset contained 71 images of diorite, gabbro, tonalite, monzodiorite,
 granodiorite, and granite with classification based on petrographic analysis
 of Cretaceous granitoids collected from Peru.
 To increase the number of images, a new dataset of 846 patches from around
 450 × 700 to 900 × 1000 pixels was generated from the first dataset.
 A deep neural network was created with 4-layer structure: two convolutional,
 and two fully connected layers.
 After each convolutional layer it was a max pooling layer of 2×2 size,
 and a flatten and a dropout layers before the first and second fully connected
 layers respectively.
 Several combinations of the rock classes were trained with 50% of the image
 patches, 100 epochs and a batch size of 32.
 The best combination was with four classes of plutonic rocks (gabbro, diorite,
 granite and granodiorite) achieving an accuracy of 95%, an average precision
 of 96%, an average recall of 95%, and an average F1-score of 95%.
 Finally, an Android application was developed using the proposed model
 trained with the best combination of rocks.
 The application evaluation results were: 70% for gabbro, 28.5% for diorite,
 100% for granodiorite, and 28.5% for granite.
\end_layout

\begin_layout Subsubsection
Recognition of mineral images applying machine learning and feature extraction
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset

, Zhang et al.
 worked on the intelligent identification of rock-mineral images using ensemble
 machine learning algorithms (model stacking).
 A total of 481 images of four minerals (K-feldspar, perthite, plagioclase,
 and quartz) were obtained with the camera on top of a microscope.
 The target RGB images were cropped to cover the minerals and then processed
 to be 299 × 299 pixels.
 A deep learning model based on Inception-v3 was adopted to extract high-level
 features (such as chromatic aberration and texture) from the images and
 train the algorithms of LR, SVM, KNN, Random Forest (RF), Multilayer Perceptron
 (MLP), and Gaussian Naive Bayes (GNB).
 LR, SVM, and MLP had a significant effect on extracted features, with higher
 accuracy (90.0%, 90.6%, and 89.8%) than the other models.
 The new features generated by these three models were employed for the
 model stacking in a new instance of LR.
 The stacking model showed a better performance than the single models,
 with an accuracy of 90.9%.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset

, Maitre et al.
 created several models of supervised machine learning to recognize mineral
 grains in a sample surface containing grains of 27 different mineral species
 (plagioclase, augite, background, hypersthene, ilmenite, magnetite, titanite,
 hornblende, etc.).
 The surface was scanned with an automated Scanning Electron Microscopy
 (SEM) that assigned to each grain a mineral specie based on its chemical
 signature.
 Also several views of the same surface were taken with a stereo-zoom binocular
 microscope to construct a large mosaic RGB image.
 Both images were divided into 3,192 sub-images of 600 × 600 pixels.
 To label the grains of the mosaic image, the simple linear iterative clustering
 (SLIC) algorithm was applied for superpixel segmentation to match each
 superpixel of the mosaic's sub-images with the superpixels of the SEM's
 scan sub-images.
 From the computed RGB superpixel histograms, the color intensity (quantile)
 and peak intensity (ratio between the number of pixels in the first and
 second maximum bins to total number of pixels) were extracted as features
 for each superpixels.
 KNN, RF, and Classification and Regression Trees (CART) algorithms were
 trained with 70% of the extracted features, and tested with the other 30%
 using the kappa statistics, precision, recall, and f1-score indicators.
 The RF algorithm gave the best results with a global accuracy of 89%.
\end_layout

\begin_layout Subsubsection
Discussion
\end_layout

\begin_layout Standard
Machine learning has been an effective way for image classification in geochemis
try.
 Specifically, feature reduction was applied in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019,Maitre2019"
literal "false"

\end_inset

 using deep learning and the simple linear iterative clustering (SLIC) algorithm
 to extract high-level features from images of mineral samples before training
 the machine learning models.
 Although these works showed good results in the classification of mineral
 samples, the number of extracted features was very large.
\end_layout

\begin_layout Standard
Four articles 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a,Ran2019,Cheng2017"
literal "false"

\end_inset

 introduce CNN topologies and analyze the performance of the models generated
 for rock lithology classification using all the image features.
 Also, in our previous work [ref], several combinations of plutonic rock
 images of 4 classes were analyzed using all the image features to train
 a CNN model rather than extracted features.
 The occurrence of redundant or irrelevant features in the acquired data
 makes the model learn based on irrelevant features
\begin_inset Note Note
status open

\begin_layout Plain Layout
doi: https://doi.org/10.1016/B978-0-12-817913-0.00014-6
\end_layout

\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a"
literal "false"

\end_inset

 ref] the created models were deployed on an Android mobile application
 for the classification of rocks.
 However, there are no works presenting the evaluation results of the deployment
 of machine learning models on iOS devices.
\end_layout

\begin_layout Standard
Finally, the evaluation of the models in 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a,Ran2019,Cheng2017"
literal "false"

\end_inset

 
\begin_inset Note Note
status open

\begin_layout Plain Layout
20, 21, 22, 25 ???
\end_layout

\end_inset

showed good results in the field.
 Nevertheless, all of them were trained with diverse types of rocks instead
 of using only the plutonic rock type.
 This type of classification becomes more difficult because rocks of the
 same type have very similar characteristics.
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Subsection
Methodology
\end_layout

\begin_layout Standard
This section describes the steps followed in this research work.
\end_layout

\begin_layout Subsubsection
Getting the images of the plutonic rocks
\end_layout

\begin_layout Standard
The images of plutonic rocks were provided by the Department of Earth and
 Biological Sciences at Loma Linda University.
 We use pictures from plutonic rocks that were classified by using petrography
 and chemistry data.
 Specifically, the dataset contains image patches of four classes of plutonic
 rocks: granite, granodiorite, gabbro, and diorite with a total of 283 images.
 The images used in the following experiments are organized in subfolders
 according to their class and are available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/tree/main/Rock-images
\end_layout

\end_inset

.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Number-of-images"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the number of images per class.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Number of images per class 
\begin_inset CommandInset label
LatexCommand label
name "tab:Number-of-images"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="7em">
<column alignment="center" valignment="middle" width="8.3em">
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Number of images
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
65
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
78
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Total of images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
283
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Preparing the data
\end_layout

\begin_layout Standard
In this step, the images were processed in order to obtain the color values
 of the image pixels in RGB and CIELAB color spaces.
\end_layout

\begin_layout Standard
First, all files (
\begin_inset Quotes eld
\end_inset

.png
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

.jpg
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

.jpeg
\begin_inset Quotes erd
\end_inset

) in the subfolders of the main directory of images were processed in RGB
 format and labeled according to their container subfolder (e.g.
 processed images in the granite subfolder are labeled as granite).
 Thereafter, the RGB values of the image pixels were converted to CIELAB
 values using the 
\begin_inset Quotes eld
\end_inset

rgb2lab
\begin_inset Quotes erd
\end_inset

 function of the color class imported from the Scikit-image module.
 In this way, it is possible to train the models in the two color spaces
 and determine which color format is the most appropriate for classifying
 the dominant colors of the 4 classes of plutonic rocks.
 The notebook with the source code for data preparation is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
http://bit.ly/3pyh3JL
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Determining the best number of color clusters
\end_layout

\begin_layout Standard
The K-means algorithm was used to extract the dominant colors from the images.
 The Elbow method was used to calculate the optimal number of clusters to
 use in K-means.
 This method consists of iterating in a range of possible cluster numbers
 and determine the best one.
 We selected the pixel values of one processed image to train K-means.
 The range of 2 to 20 was declared to obtain the scores of K-means at each
 cluster number.
 Finally, we plotted these scores with their respective 
\shape italic
k
\shape default
 number.
 The number at the elbow in the plot indicates the best 
\shape italic
k
\shape default
 number of clusters, which is 4 for this experiment 
\shape italic
\emph on
(see Fig.
 
\shape default
\emph default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Elbow-method"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Elbow curve.png
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Elbow method showing the optimal k number of clusters 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-Elbow-method"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Color extraction
\end_layout

\begin_layout Standard
In this step, the dominant colors are extracted from the rock images.
 In Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:get-dominant-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the 
\begin_inset Quotes eld
\end_inset

get_dominant_colors
\begin_inset Quotes erd
\end_inset

 function receives the pixel values of an image to train the K-means algorithm
 with 
\shape italic
k
\shape default
 clusters.
 In line 6, K-means works by separating the pixels of the image into 4 clusters
 of similarly colored pixels.
 The colors at each cluster center reflect the average value of the attributes
 of all members of a cluster.
 The percentage of a cluster is the number of pixels within that color cluster
 and is calculated in lines 8 to 10.
 Finally, the centroid of each cluster and its percentage are sorted in
 increasing order of percentage and added to a features list in lines 12
 to 17.
 The returned list in line 19 are the sixteen features: the four dominant
 colors represented by the three channels of the selected color format and
 the percentage of each dominant color (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Dominant-colors-and"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/get dominant colors.txt"
lstparams "language=Python,caption={Function to extract the dominant colors from a single image},label={list:get-dominant-colors}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Color extraction.png
	lyxscale 15
	width 95col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Sample rocks with their dominant colors in percentage order and their average
 color
\begin_inset CommandInset label
LatexCommand label
name "fig:Dominant-colors-and"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:iterate-to-extract-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the processed data in RGB format is iterated in lines 4 to 6 and to extract
 the dominant colors in line 5 with the function of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:get-dominant-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The colors are added to a new list of extracted colors in line 6.
 This process is also made for the CIELAB data in lines 8 and 9.
 Finally, the extracted colors in RGB and CIELAB formats are saved together
 with their respective rock label in different CSV files.
 These files were used in the next step to train the machine learning algorithms.
 The CSVs with the extracted dominant colors in RGB and CIELAB color spaces
 are available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/colors_RGB.csv
\end_layout

\end_inset


\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/colors_LAB.csv
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/Iterate in data to extract colors.txt"
lstparams "language=Python,caption={Iterate original data to extract dominant colors},label={list:iterate-to-extract-colors}"

\end_inset


\end_layout

\begin_layout Subsubsection
Data normalization and label encoding
\end_layout

\begin_layout Standard
First, in this step we loaded the dominant colors data from the CSVs.
 The dominant colors and their percentage are the data features loaded into
 
\shape italic
x
\shape default
, and the rock classes are the data labels loaded into 
\shape italic
y
\shape default
.
 Second, in order to train and test the models, the 
\shape italic
x
\shape default
 and 
\shape italic
y
\shape default
 data were divided into a training set of 80% and a test set of 20% using
 the 
\begin_inset Quotes eld
\end_inset

train_test_split
\begin_inset Quotes erd
\end_inset

 function of the model_selection class from Scikit-learn.
 Thereafter, we normalized the 
\shape italic
x
\shape default
 data of train and test sets using the 
\begin_inset Quotes eld
\end_inset

MinMaxScaler
\begin_inset Quotes erd
\end_inset

 function imported from the preprocessing class of Scikit-learn.
 This function scales each feature to a given range of 0 to 1 for data cleaning
 and better performance in model training.
 Finally, we encoded the 
\shape italic
y
\shape default
 data in order to train the machine learning models transforming the labels
 into values from 0 to 3 representing the four rock classes of plutonic
 rocks: gabbro, diorite, granodiorite, and granite respectively.
 The encoding process was made with the 
\begin_inset Quotes eld
\end_inset

LabelEncoder
\begin_inset Quotes erd
\end_inset

 function of the preprocessing class imported from Scikit-learn module.
\end_layout

\begin_layout Subsubsection
Training the different algorithms with the extracted dominant colors
\end_layout

\begin_layout Standard
Five machine learning models were trained using the RGB data and afterwards
 the CIELAB data in this experiment: LR, KNN, DT, SVM, and a CNN.
 The notebook showing the code for training and validation of the generated
 models is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/ML-training.ipynb
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Listings 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-LR"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 present the set and training process of the models.
 The LR, KNN and CNN models were trained with the normalized data while
 the DT and SVM models with non-normalized data.
 The following configurations were used to set the models:
\end_layout

\begin_layout Standard
LR was created in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-LR"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the L-BFGS (Limited-memory Broyden–Fletcher–Goldfarb–Shanno) solver
 which is one of the quasi-Newton methods that approximate the BFGS algorithm,
 which utilizes a limited amount of computer memory.
 The solver's methodology starts iterating at a random point (
\shape italic
xt
\shape default
) to calculate the minimum from the second derivate of the original function
 at that point and assign it to a new point (xt+1).
 The new point will become the starting point for the next iteration.
 In this way, L-BFGS quickly converges on the solution 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train LR.txt"
lstparams "language=Python,caption={Configuration and training of LR},label={list:train-LR}"

\end_inset


\end_layout

\begin_layout Standard
The number of neighbors used for KNN in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-KNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 represents the neighbor samples analyzed from the dataset to classify a
 new sample into the class to which most of their neighbors belong.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train KNN.txt"
lstparams "language=Python,caption={Configuration and training of KNN},label={list:train-KNN}"

\end_inset


\end_layout

\begin_layout Standard
By using class weights, we can increase the importance of a particular class
 during training.
 DT is created in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-DT"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the balanced mode for class weight that uses the label values of the
 training set to automatically adjust the node weights inversely proportional
 to the class frequencies in the input data 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train DT.txt"
lstparams "language=Python,caption={Configuration and training of DT},label={list:train-DT}"

\end_inset


\end_layout

\begin_layout Standard
SVM is created in line 3 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-SVM"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the Radial Basis Function (RBF) kernel which is useful to eliminate
 the computational requirement of the algorithm.
 When training an SVM with RBF, the parameter gamma must be considered.
 The auto value of gamma in Scikit-learn is represented by 
\begin_inset Formula $1/number\ of\ features$
\end_inset

.
 Gamma defines how much influence a single training example has.
 The larger that gamma is, the closer other examples must be to be affected
 
\begin_inset CommandInset citation
LatexCommand citep
key "Scikit-SVC"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train SVM.txt"
lstparams "language=Python,caption={Configuration and training of SVM},label={list:train-SVM}"

\end_inset


\end_layout

\begin_layout Standard
The proposed CNN model is a four-layer structure: two one-dimensional convolutio
nal layers and two fully-connected layers.
 There is a maxpooling layer after each convolutional layer and a flatten
 layer is placed between the two convolutional layers and the fully connected
 layers.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:CNN-model-structure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 describes the structure of the CNN model created in Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
CNN model structure 
\begin_inset CommandInset label
LatexCommand label
name "tab:CNN-model-structure"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="6.8em">
<column alignment="center" valignment="middle" width="3.2em">
<column alignment="center" valignment="middle" width="3.4em">
<column alignment="center" valignment="middle" width="4.7em">
<column alignment="center" valignment="middle" width="4.5em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Layer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Filters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kernel size
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Activation function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output shape
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Input features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conv1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MaxPooling1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conv1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8 × 64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MaxPooling1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4 × 64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flatten
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
256
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dense
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dense
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Softmax
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In line 7 of Listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 the sequential model of the Keras
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://keras.io
\end_layout

\end_inset

 library from Tensorflow was defined.
 This model is formed by layers where each layer has exactly one input tensor
 and one output tensor.
 In lines 8 and 10 two convolutional layers of one dimension were added
 to the model using RELU as their activation function, 2 as kernel size,
 and a total of 32 and 64 filters respectively.
 This kind of layer creates a convolution kernel that is convolved with
 the layer input to produce a tensor of the output filters dimension.
 Moreover, RELU applies the Rectified Linear Unit activation function which
 is used to achieve non-linearity converting the negative values of the
 output tensor to 0 value after convolution operation 
\begin_inset CommandInset citation
LatexCommand citep
key "Mitchell2019"
literal "false"

\end_inset

.
 In lines 9 and 11 the maxpooling layers are added with a size of 2 after
 each convolutional layer.
 This kind of layer downsamples the input by taking the maximum value over
 a window defined by pool size.
 In line 12 the flatten layer flattens the input to one dimension.
 In lines 13 and 14 two fully connected layers are added using 64 and 4
 as their number of filters, the activation functions of RELU and Softmax
 respectively.
 The Softmax function is generally used in the output layer because it normalize
s a vector containing 
\shape italic
k
\shape default
 elements into a probability distribution over the 
\shape italic
k
\shape default
 elements.
 In this case, the last layer 4 filters are the CNN output tensor that contains
 the probabilities of the four rock classes 
\begin_inset CommandInset citation
LatexCommand citep
key "Dawani2020"
literal "false"

\end_inset

.
 In line 15, the model was compiled with the categorical cross-entropy loss
 function and the Adam optimizer.
 Categorical cross-entropy is the most diffused classification cost function,
 adopted by logistic regression and the majority of neural architectures.
 This convex function can be easily optimized using stochastic gradient
 descent techniques and is an excellent choice for classification problems
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonaccorso2018"
literal "false"

\end_inset

.
 On the other hand, Adam (adaptive moment estimation) algorithm is an efficient
 optimization method that computes adaptive learning rates for each parameter
 to optimize the weights of the model 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
 Finally, to train the CNN several numbers of epochs and batches were tried
 until the most optimal values were obtained as shown in line 19.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train CNN.txt"
lstparams "language=Python,caption={Configuration and training of CNN},label={list:train-CNN}"

\end_inset


\end_layout

\begin_layout Subsubsection
Evaluation of the machine learning algorithms
\end_layout

\begin_layout Standard
Evaluating a supervised learning algorithm during the evaluation and testing
 phases is an essential part of any well-made machine learning pipeline.
 The following four metrics were used in this project to evaluate the algorithms
:
\end_layout

\begin_layout Itemize
Accuracy is the ratio of the number of correct predictions made to the number
 of all predictions made 
\begin_inset CommandInset citation
LatexCommand citep
key "Galeone2019"
literal "false"

\end_inset

.
\begin_inset Formula 
\[
Accuracy=\frac{Correct\ Predictions}{Predictions\ Made}
\]

\end_inset


\end_layout

\begin_layout Itemize
Precision is the number of correct positives results, divided by the number
 of positive results predicted 
\begin_inset CommandInset citation
LatexCommand citep
key "Galeone2019"
literal "false"

\end_inset

.
\begin_inset Formula 
\[
Precision=\frac{TP}{TP+FP}
\]

\end_inset


\end_layout

\begin_layout Itemize
Recall is the number of correct positive results, divided by the number
 of all relevant samples (all the samples that should be classified as positive)
 
\begin_inset CommandInset citation
LatexCommand citep
key "Galeone2019"
literal "false"

\end_inset

.
\begin_inset Formula 
\[
Recall=\frac{TP}{TP+FN}
\]

\end_inset


\end_layout

\begin_layout Itemize
F1-score is the harmonic mean between precision and recall.
 This number, which is in the [0,1] range, indicates how precise the classifier
 is (precision) and how robust it is (recall).
 The greater the F1 score, the better the overall performance of the model
 
\begin_inset CommandInset citation
LatexCommand citep
key "Galeone2019"
literal "false"

\end_inset

.
\begin_inset Formula 
\[
F1=2*\frac{Precision*Recall}{Precision+Recall}
\]

\end_inset


\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-accuracy"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the average accuracy results of the algorithms evaluated with the
 test set of dominant colors in RGB and CIELAB color formats.
 The models generated with the algorithms of KNN, SVM, and CNN showed their
 best results using the dominant colors of CIELAB format.
 LR results were only slightly better in CIELAB than RGB.
 On the other hand, DT results were slightly better in RGB than CIELAB format.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of all the algorithms in terms of accuracy 
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-accuracy"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="middle" width="8.5em">
<column alignment="center" valignment="middle" width="4.6em">
<column alignment="center" valignment="middle" width="4.6em">
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent

\series bold
Model
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Accuracy
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
RGB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
CIELAB
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
Logistic Regression
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.63
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.63
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
KNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.93
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
Decision Trees
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.72
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
SVM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.52
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.80
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.82
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Tables 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-LR"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-CNN"
plural "false"
caps "false"
noprefix "false"

\end_inset

 show the results of each model evaluation in terms of precision, recall,
 and F1-score for the CIELAB color spaces.
 The best results were obtained with the KNN model using the CIELAB color
 space with the highest average values of accuracy, precision, recall, and
 F-score equal to 93%.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Logistic Regression 
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-LR"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="middle" width="6em">
<column alignment="center" valignment="middle" width="4.5em">
<column alignment="center" valignment="middle" width="4.5em">
<column alignment="center" valignment="middle" width="4.5em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.77
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.61
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.35
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.44
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.56
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.90
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.66
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.63
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of K-Nearest Neighbors
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="6em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.96
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.94
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.85
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.96
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.93
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Decision Trees
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="6em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.56
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.62
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.86
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.89
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.72
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Support Vector Machine
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="6em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.81
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.80
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.80
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of the Convolutional Neural Network 
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-CNN"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="6em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.90
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.76
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.81
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.62
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.96
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.82
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement t
wide true
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Workflow.png
	lyxscale 50
	width 85page%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Application workflow 
\begin_inset CommandInset label
LatexCommand label
name "fig:Application-workflow"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Results
\end_layout

\begin_layout Standard
The KNN model was the model deployed in the iOS mobile application to make
 the classification of images of four classes of plutonic rocks in real
 time.
 The Xcode IDE, the Xcode command-line tools, a valid Apple Developer ID,
 and the CocoaPods dependency manager were the main requirements to develop
 the application.
 The application is written mostly in Swift and uses the following two libraries
 for performing the dominant colors extraction and image classification:
\end_layout

\begin_layout Itemize
The DominantColor
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/indragiek/DominantColor
\end_layout

\end_inset

 dependency is an open source library written in Swift and created by Indragie
 Karunaratne.
 It finds the dominant colors of an image using the CIELAB color space and
 the K-means clustering algorithm.
 In this project an adaptation of this library was implemented exporting
 code from the 7 main files of the repository into the application project.
\end_layout

\begin_layout Itemize
The TensorFlowLite Swift
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/swift
\end_layout

\end_inset

 library is TensorFlow's lightweight solution for Swift developers.
 It enables low-latency inference of on-device machine learning models with
 a small binary size and fast performance supporting hardware acceleration.
 For the application, TensorFlowLiteSwift pod name was added into the project's
 Podfile, and from command line the library was resolved into the Xcode
 project by the CocoaPods dependency manager.
\end_layout

\begin_layout Standard
As a required step for the deployment of the KNN model in the application
 it was necessary to export the model by creating and training a concrete
 function in TensorFlow.
 This function calculates the Manhattan distance of a new data point to
 all the points in training data to select the label of the nearest point
 as the label of the new point.
 The last step in the model exportation was to create a graph of the trained
 model from the concrete function.
 That graph was exported in a file with tflite extension using TensorFlow
 Lite.
 The source code of the creation and exportation of KNN in TensorFlow is
 available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/ML-training.ipynb
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Listed below is the application process (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Application-workflow"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The source code of the application is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Rock-Classifer-iOS
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
There are two ways of making the classification on the iOS application.
 The first way is to take a picture with the 
\begin_inset Quotes eld
\end_inset

OpenCamera
\begin_inset Quotes erd
\end_inset

 button that is shown in step 1A of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Application-workflow"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 When camera opens, a new scene appears displaying the device camera to
 take the picture as shown in step 2A.
 The second way is choosing a photo from the 
\begin_inset Quotes eld
\end_inset

Photo Library
\begin_inset Quotes erd
\end_inset

.
 The 
\begin_inset Quotes eld
\end_inset

OpenLibrary
\begin_inset Quotes erd
\end_inset

 button of step 1B opens the photo library screen of the iOS device as is
 shown in step 2B.
 After the image was loaded the extraction is performed with the 
\begin_inset Quotes eld
\end_inset

dominantColorsInImage
\begin_inset Quotes erd
\end_inset

 function imported from the 
\begin_inset Quotes eld
\end_inset

DominantColor
\begin_inset Quotes erd
\end_inset

 library.
 Thereafter, the Classify button in step 3 is enabled to classify the new
 rock image into: granite, granodiorite, gabbro, and diorite.
 At this step the previous extracted colors are converted to a buffer of
 CIELAB color data.
 The colors are sorted in descending order by their percentage of pixels
 in the image and used as the input tensor for the tflite file containing
 the graph of the KNN model.
 Optionally, the dominant colors and the average colors of the selected
 image can be displayed pressing the 
\begin_inset Quotes eld
\end_inset

Extracted
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Average
\begin_inset Quotes erd
\end_inset

 buttons of steps 4A and 4B respectively as shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Application-workflow"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Bias of our approach
\end_layout

\begin_layout Standard
In order to get good results in the field it is required to use pictures
 of rocks taken under good light settings, avoid taking pictures of samples
 with evidence of weathering and oxidation or covered by vegetation, as
 these features will limit the recognition accuracy of shades and colors
 in the rock.
 However, in many cases it is difficult to obtain the proper settings when
 images are taken at different outdoor locations and times of the day.
 For this reason, it is necessary to increase our dataset with images taken
 under the different conditions in which the image could be found such as
 angles, distance, light, shadows, weathering, vegetation and others.
 In addition, the classification of more rock types will allow the model
 to distinguish the most characteristic shadows and colors of each type.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
I think we should add a sub-section at the end of the Results section, to
 explain the limitations/bias of our approach.
 For example, the way the picture was taken, the amount of light interacting
 with the rock/outcrop, the weathering/alteration/oxidation of the sample…these
 features will limit the accuracy of the recognition of color/shade in the
 rock.
 You got a comment about this from a reviewer of the paper submitted to
 Applied Computing and Geosciences and Ben and I will work on addressing
 these concerns.
 Basically, it is required to use pictures of rocks taken under good light
 settings, avoid taking pictures of samples with evidence of weathering
 or cover by vegetation… these details or directions need to be provided
 to the user of the app in order to get good results.
\end_layout

\begin_layout Plain Layout
....
\end_layout

\begin_layout Plain Layout
In future work, the datasets for training and validation will be extended
 with a larger number of plutonic rock images taken in the field, not in
 the lab, under different conditions (e.g., different distances, angles, lighting
 effects – blue vs.
 cloudy sky, weathering or alteration, shadows, vegetation, and moss).
 Also, a larger dataset will allow to avoid the process of image data augmentati
on in the validation dataset to count on two completely different datasets
 for training and validation.
 In addition, we are planning to obtain images for other classes of plutonic
 rocks.
 With the larger dataset, we expect to extend our mobile application with
 a new classification model able to classify rocks for a wide range of classes.
 Moreover, the results of the classification model will be compared with
 other convolutional neural networks.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Discussion
\end_layout

\begin_layout Standard
Five machine learning algorithms were trained with just the four dominant
 colors extracted from images of plutonic rocks.
 The best algorithm in this experiment was K-Nearest Neighbors trained with
 the dominant colors in the CIELAB color format of 283 images.
 Its values of accuracy, precision, recall, and F-score average were equal
 to 93%.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Comparison-of-the"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the comparison of these results and the results of our previous
 approach with a CNN using all the image features [ref].
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of the average accuracies of this research with our previous
 work
\begin_inset CommandInset label
LatexCommand label
name "tab:Comparison-of-the"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="middle" width="6em">
<column alignment="center" valignment="middle" width="6em">
<column alignment="center" valignment="middle" width="8em">
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Metrics
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
KNN of this work with four dominant colors
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
CNN of our previous work [ref] with all the features used during training
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Accuracy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
96%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
F1-score
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
93%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The application running the K-Nearest Neighbors model was tested in the
 field with 34 images and the following average accuracy results were obtained:
 85.7% for granite, 20% for granodiorite, 28.5% for diorite, and 70% for gabbro.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-comparison-of"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows a comparison with the results of the Android application of our previous
 work in the field.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results comparison of the iOS application and the Android application of
 our previous work in the field
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-comparison-of"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="6">
<features tabularvalignment="middle">
<column alignment="left" valignment="middle" width="5em">
<column alignment="center" valignment="middle" width="3em">
<column alignment="center" valignment="middle" width="3em">
<column alignment="center" valignment="middle" width="3em">
<column alignment="center" valignment="middle" width="3em">
<column alignment="center" valignment="middle" width="3em">
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Taken images
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none" width="8em">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Correctly classified in this work
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none" width="8em">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Correctly classified in our previous work
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Percent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Percent
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
85.7%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.5%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.5%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Total
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
34
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
50%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
61%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
This shows a big difference between granite and granodiorite between the
 two works, but I am wondering whether the percentages got switched in one
 case?.
 So granite had high accuracy in this work … why not before?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results of our approach with dominant colors were very similar as the
 obtained in our previous work [ref] using all the image features.
 The results were good for gabbro, and below expectations for diorite.
 On the other hand, there is a big difference for granite and granodiorite
 between the two works in which the percentages got switched.
 Granite showed much better results with the dominant color approach.
 Moreover, these results were not the same with granodiorite which was the
 best performing class in our previous work [ref].
 This is because a classification model such as CNN used in our previous
 work extracts general rock features, not only shades and colors, which
 in the case of granite seems a very important feature for its classification.
 Combining the features extracted by CNN and the dominant colors before
 training a machine learning model could improve the results of our approach
 for granodiorite as well.
\end_layout

\begin_layout Standard
The high accuracy when classifying gabbro samples was because they are noticeabl
e darker than samples of the other three classes.
 Similarly, granites were noticeably lighter.
 In contrast, diorite and granodiorite share characteristics of the other
 rock types closest to them in the dark-light sequence; therefore, it is
 more difficult to automatically classify them based on their dominant colors.
 According to the results of the iOS application in the field, our hypothesis
 was not fulfilled.
 The results for granodiorite and diorite show the need for improving the
 classification model with a higher number of images that cover a variety
 of colors per class.
\end_layout

\begin_layout Section
Conclusions and Future Work
\end_layout

\begin_layout Standard
This paper proposed low-level feature extraction in color-based images for
 training several machine learning models.
 Feature extraction serves the function of detecting and separating fundamental
 parts of digital images.
 Moreover, it simplifies a complex input dataset into a set of features
 in a reduced order
\begin_inset Note Note
status open

\begin_layout Plain Layout
ISSN: 2278-0181
\end_layout

\end_inset

.
 The color-dominant approach presented in this work can be useful in classificat
ions where color is important to differentiate images.
\end_layout

\begin_layout Standard
Future improvements to this work can be made to the results for granodiorite
 and diorite with a larger number of images covering a variety of colors
 per class.
 Furthermore, another important low-level feature in the classification
 of plutonic rocks is the shapes of their crystals.
 Adding this feature to the training of machine learning models can improve
 the results of plutonic rocks that have similar colors as was the case
 for diorite and granodiorite.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "Rocks"

\end_inset


\end_layout

\end_body
\end_document
