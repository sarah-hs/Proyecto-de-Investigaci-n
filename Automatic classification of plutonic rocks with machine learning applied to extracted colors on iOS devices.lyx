#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass IEEEtran
\begin_preamble
% for subfigures/subtables
\usepackage{titlesec}
\titlespacing{\subsubsection}{0pt}{0.6em}{0pt}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{diagbox}
\usepackage{array}
\usepackage{listings}
\lstdefinelanguage{Swift}{language=bash,morekeywords={fix},}
\usepackage{color}
\definecolor{lightgray}{RGB}{246,246,246}
\definecolor{darkgray}{RGB}{128,128,128}
\end_preamble
\options journal
\use_default_options false
\begin_modules
graphicboxes
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding ascii
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "Your Title"
\pdf_author "Your Name"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle false
\pdf_quoted_options "pdfpagelayout=OneColumn, pdfnewwindow=true, pdfstartview=XYZ, plainpages=false"
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine biblatex-natbib
\cite_engine_type numerical
\biblio_style jurabib
\biblatex_bibstyle ieee
\biblatex_citestyle numeric
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 2
\papersides 1
\paperpagestyle default
\listings_params "breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\scriptsize\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\scriptsize\ttfamily},xleftmargin={0.7cm},framexleftmargin={0.7em},numbersep=8pt,tabsize=3,backgroundcolor={\color{lightgray}},commentstyle={\color{darkgray}}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align left
\begin_inset Graphics
	filename Images/Logo_UM.png
	lyxscale 7
	width 2.5cm
	height 2.5cm
	keepAspectRatio

\end_inset


\begin_inset space \hspace{}
\length 12cm
\end_inset


\begin_inset Graphics
	filename Images/Logo_FIT.png
	lyxscale 75
	width 2.5cm
	height 2.5cm
	keepAspectRatio

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size huge
Universidad de Montemorelos
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 0.8cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Facultad de Ingeniería y Tecnología
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Ingeniería en Sistemas Computacionales
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size huge
Automatic classification of plutonic rocks with machine learning applied
 to extracted colors on iOS devices
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Sarah Hernández Serrano
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
1170469
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Asesor: Dr.
 Germán Harvey Alférez Salinas
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Co-asesores: Dr.
 Benjamin Clausen and Dra.
 Ana María Martínez Ardila
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.4cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Montemorelos, Nuevo León, México
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
00 de mayo de 2021
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 7cm
\end_inset


\end_layout

\begin_layout Abstract
The classification of different rocks can provide important information
 about the conditions under they were formed and their tectonic environment.
 Color is a key property for rock classification.
 However, it is difficult to describe them because perceived colors in rocks
 also depend on the observer's experience with similar observations.
 Moreover, the equipment for rock classification is expensive, which makes
 this equipment prohibitive to geology students and amateurs.
 The contribution of this research work is twofold.
 First, since color is a key property for rock classification, feature reduction
 was applied in rock images extracting just the four dominant colors before
 training the machine learning algorithms; to this end, the k-means clustering
 method was used.
 Second, we present an iOS application that uses machine learning to classify
 images of the following plutonic rocks: granite, granodiorite, gabbro,
 and diorite.
 Different machine learning models were created and evaluated with the Logistic
 Regression, K-Nearest Neighbors, Decision Trees, Support Vector Machine,
 and Convolutional Neural Network algorithms.
 The best results were achieved with K-Nearest Neighbors algorithm.
 The evaluation results of the algorithm are the following: 82% of accuracy,
 84% of precision, 89% of recall, and 83% of F1-score.
\end_layout

\begin_layout Keywords
Machine Learning, Color Extraction, iOS Devices, Geology, Rock Classification,
 Features Reduction, Dominant Colors, K-means Clustering, Logistic Regression,
 K-Nearest Neighbors, Support Vector Machine, Convolutional Neural Network,
 Decision Trees.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Title
Automatic classification of plutonic rocks with machine learning applied
 to extracted colors on iOS devices
\end_layout

\begin_layout Author
Sarah
\begin_inset space ~
\end_inset

Hernández,
\begin_inset space ~
\end_inset

Germán
\begin_inset space ~
\end_inset

H.
\begin_inset space ~
\end_inset

Alférez,
\begin_inset space ~
\end_inset

Benjamin
\begin_inset space ~
\end_inset

Clausen
\begin_inset space ~
\end_inset

and
\begin_inset space ~
\end_inset

Ana
\begin_inset space ~
\end_inset

M.
\begin_inset space ~
\end_inset

Martínez 
\begin_inset Foot
status open

\begin_layout Plain Layout
Sarah
\begin_inset space ~
\end_inset

Hernández is a computer science engineering student at the School of Engineering
 and Technology of Montemorelos University, Nuevo León, Mexico, e-mail:
 
\begin_inset CommandInset href
LatexCommand href
target "1170469@alumno.um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Germán H.
 Alferez, Ph.D., is the director of the Institute of Data Science and professor
 at the School of Engineering and Technology of Montemorelos University,
 Nuevo León, Mexico, e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "harveyalferez@um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Benjamin Clausen, Ph.D., is a professor at the Department of Earth and Biological
 Sciences of Loma Linda University, California, United States, e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "bclausen@llu.edu"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Ana M.
 Martínez, Ph.D., is a professor at the Department of Earth and Biological
 Sciences of Loma Linda University, California, United States, e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "anmartinez@llu.edu"
literal "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Special Paper Notice
School of Engineering and Technology, Montemorelos University, Mexico
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Subsection
Background
\end_layout

\begin_layout Standard
\begin_inset Flex Paragraph Start
status open

\begin_layout Plain Layout
\begin_inset Argument 1
status open

\begin_layout Plain Layout
T
\end_layout

\end_inset


\end_layout

\end_inset

he classification of different rocks can provide important information about
 the conditions under which they were formed.
 They can also tell us much about their tectonic environment, given that
 they are closely linked to the convection of tectonic plates.
 Their mineral and chemical makeup can be used to learn about the composition,
 temperature and pressure that exists within the Earth’s mantle 
\begin_inset CommandInset citation
LatexCommand citep
key "Williams-2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Plutonic rocks are a type of igneous rock (one of the three main types of
 rocks in the world and also the most common) formed when magma in the middle
 of the volcano cools and solidifies below the Earth’s surface.
 They come in many different sizes and colors, and have a wide variety of
 uses 
\begin_inset CommandInset citation
LatexCommand citep
key "NGS-2019,Study-2013"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Our contribution is twofold: extract the dominant colors of plutonic rock
 images and use these information to classify them with the implemention
 of machine learning.
 Color changes in rocks may indicate changes in the rock’s mineral assemblage,
 texture, organic carbon content (shales), or other properties 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
 That is why color is a key property for rock classification.
 In addition, machine learning, a branch of artificial intelligence, provides
 easy classification of images whitin mobile applications and is becoming
 an appealing tool in various fields of earth sciences, especially in prediction
s and resources estimation 
\begin_inset CommandInset citation
LatexCommand citep
key "Cate2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
In [], a previous work by Elías L.
 Vázquez and Germán H.
 Alférez has be done for the classification of plutonic rocks on android
 devices using the whole set of features of the same dataset instead of
 just the color extracted features.
\end_layout

\begin_layout Subsection
Problem Statement
\end_layout

\begin_layout Standard
The equipment for rock classification is expensive, which makes it prohibitive
 to geology students and amateurs.
 In addtion, despite the fact that color is a key property for rock classificati
on, it is an attribute difficult to describe because perceived colors in
 rocks also depend on the stimulus area and the observer's experience with
 similar observations; so a color may often be named differently by different
 persons 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Justification
\end_layout

\begin_layout Standard
There are two reasons to create an iOS mobile application that allows the
 classification of rocks through colors with machine learning.
 First, no such application exists.
 A mobile application offers the flexibility to carry out the classification
 on real time and could be an alternative to expensive traditional methods
 of rock classification.
 Second, the extraction of the dominant colors allows geologists to more
 accurately detect color changes in rocks and is useful to reduce the number
 of features in images used to train machine learning, which provides easy
 classification of rocks within the application.
\end_layout

\begin_layout Subsection
Objectives
\end_layout

\begin_layout Standard
The main objective of this research work is to create an iOS application
 that uses machine learning to extract the dominant colors from images and
 use these colors to classify plutonic rocks.
 This objective is achieved with the following sub-objectives:
\end_layout

\begin_layout Itemize
Determine the best k number of clusters to use in the k-means clustering
 machine learning method to extract the dominant colors from images of plutonic
 rocks.
\end_layout

\begin_layout Itemize
Use the extracted dominant colors and the percentage of pixels belonging
 to each color cluster as the input to train the following machine learning
 algorithms: Logistic regression (LR), K-Nearest Neighbors (KNN), Decision
 Trees (DT), Support Vector Machine (SVM), and a Convolutional Neural Network
 (CNN).
\end_layout

\begin_layout Itemize
Validate the models generated to get the best suited to deploy the best
 model on the iOS mobile application.
\end_layout

\begin_layout Itemize
Test the effectiveness of the application with images taken from new plutonic
 rocks to compare the results with our previous work in which a CNN was
 trained with images using the whole set of features.
 
\end_layout

\begin_layout Subsection
Hypothesis
\end_layout

\begin_layout Standard
The training of a machine learning model with just the dominant colors extracted
 from rock images can provide an effective way for the classification of
 plutonic rock images.
\end_layout

\begin_layout Section
Theoretical Foundation
\end_layout

\begin_layout Subsection
Underpinnings of our Approach
\end_layout

\begin_layout Standard
Our approach is based on the following concepts 
\shape italic
\emph on
(see Fig.
 
\shape default
\emph default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Underpinnings-of-our"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Map of concepts.png
	lyxscale 20
	width 100col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Underpinnings of our approach 
\begin_inset CommandInset label
LatexCommand label
name "fig:Underpinnings-of-our"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Plutonic rocks
\end_layout

\begin_layout Standard
Plutonic rocks are solidified inside the earth’s crust, usually from magma,
 although they may have been formed by a different mechanism.
 Plutonic rocks are generally coarse-grained, but not all coarse-grained
 rocks are plutonic 
\begin_inset CommandInset citation
LatexCommand citep
key "RACEFEN-gg"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
According to 
\begin_inset CommandInset citation
LatexCommand citep
key "RACEFEN-gg"
literal "false"

\end_inset

, granite rocks are plutonic rocks with a granular texture, composed of
 similar amounts of quartz, potassium feldspar, and plagioclase as essential
 minerals, and smaller amounts of one or more minerals, such as biotite,
 muscovite or hornblende.
\end_layout

\begin_layout Standard
Granodiorite is a plutonic rock of the granitoid family, characterized by
 quartz because plagioclase constitutes more than 2/3 of the total feldspars.
 Generally, together with granite, it is the most abundant rock of the great
 batholiths.
 Its volcanic equivalent is dacite.
 Granodiorite is similar to granite, but with less potassium feldspar and
 more plagioclase.
\end_layout

\begin_layout Standard
Gabbro is a plutonic rock composed mainly of calcium plagioclase and clinopyroxe
ne or orthopiroxene, with or without olivine or amphibole.
 It is the intrusive equivalent of basalt.
 It is distinguished from diorite by the nature of plagioclase, which is
 higher in calcium than in sodium.
\end_layout

\begin_layout Standard
Diorite has about the same structural properties as granite but darker colour
 and more limited supply.
 Commonly is composed of about two-thirds plagioclase feldspar and one-third
 dark-coloured minerals, such as hornblende or biotite.
 The presence of sodium-rich feldspar, oligoclase or andesine, in contrast
 to calcium-rich plagioclase, labradorite or bytownite, is the main distinction
 between diorite and gabbro 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Diorite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Machine Learning
\end_layout

\begin_layout Standard
Machine learning is a branch of artificial intelligence that lies at the
 intersection of computer science, engineering, and statistics and often
 appears in other disciplines.
 Machine Learning systems can be classified according to the type of supervision
 they get during training 
\begin_inset CommandInset citation
LatexCommand citep
key "Harrington2012,Geron2019"
literal "false"

\end_inset

.
 In this way, there are two major categories:
\end_layout

\begin_layout Paragraph
Supervised learning
\end_layout

\begin_layout Standard
In supervised learning, the training set fed to the algorithm includes the
 desired solutions, called labels.
 A typical supervised learning task is classification 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Some common algorithms of supervised learning are described as follows:
\end_layout

\begin_layout Itemize
Logistic Regression (LR) is commonly used to estimate the probability of
 an instance to belong to a particular class.
 This model computes a weighted sum of the input features (plus a bias term)
 and outputs the logistic of this result.
 The logistic is a sigmoid function that outputs a number between 0 and
 1.
 This makes it a binary classifier 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
K-Nearest Neighbors (KNN) is a simple algorithm in which its priniciple
 is to find a predefined number of training samples closest in distance
 to the new point, and predict the label from these.
 Being a non-parametric method, it is often successful in classification
 situations where the decision boundary is very irregular 
\begin_inset CommandInset citation
LatexCommand citep
key "sklearn-KNN"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Decision Trees (DT) algorithm consists of split nodes and leaf nodes.
 Each split node performs a split decision and routes a data sample either
 to the left or the right child node.
 In the tree structures, leaves represent the labels, non-leaf nodes are
 the input features, and branches represent conjunctions of features that
 lead to the classifications 
\begin_inset CommandInset citation
LatexCommand citep
key "REINDERS201965,TAN2015493"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Support Vector Machine (SVM) algorithm is a powerful and versatile machine
 learning model, particularly well suited for classification of complex
 small- or medium-sized datasets.
 In this algorithm, the data is plotted in a n-dimensional space (number
 of features) and a decision boundary (hyperplane) split it into classes
 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019,Harrington2012"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Convolutional Neural Networks (CNNs) emerged from the study of the brain’s
 visual cortex.
 The most important building block is the convolutional layer.
 The CNN´s architecture consists of several connected layers allowing the
 network to concentrate on small low-level features in the first hidden
 layer, then assemble them into larger higher-level features in the next
 layer, and so on 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Unsupervised learning
\end_layout

\begin_layout Standard
In unsupervised learning the training data is unlabeled.
 One of the most important unsupervised learning algorithms is k-means.
 K-means is a simple algorithm capable of clustering an unlabeled dataset
 very quickly and efficiently, often in just a few iterations.
 You have to specify the number of clusters k that the algorithm must find
 and it could easily label all the instances in the dataset by assigning
 each of them to the cluster whose centroid is closest 
\begin_inset CommandInset citation
LatexCommand citep
key "Geron2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Dominant colors
\end_layout

\begin_layout Standard
The dominant colors refer to the principal colors presented in an image.
 The dominant colors of an image are selected grouping the image pixels
 according to their color in the RGB (Red, Green, Blue) additive color space.
 The average color of each group are the dominant colors and the number
 of pixels of that groups are the dominant colors´ percentage.
\end_layout

\begin_layout Standard
In the RGB space, the light spectra of varying fractions of the three primary
 colors referred to as channels, combine to make new colors.
 Each channel has intensity values from 0 to 1 that are scaled by the number
 of bits used to represent each component.
 The 24-bit color cube used in this research has components in the range
 of 0–255.
 Each color in the color space can be represented as a three-value vector
 
\begin_inset CommandInset citation
LatexCommand citep
key "Wallace2002"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Underlying technologies
\end_layout

\begin_layout Paragraph
Scikit learn
\end_layout

\begin_layout Standard
Scikit-learn is a Python module that integrates a wide range of state-of-the-art
 machine learning algorithms for medium-scale supervised and unsupervised
 problems.
 This package focuses on bringing machine learning to non-specialists using
 a general-purpose high-level language.
 Emphasis is put on ease of use, performance, documentation, and API consistency.
 It has minimal dependencies and is distributed under the simplified BSD
 license, encouraging its use in both academic and commercial settings 
\begin_inset CommandInset citation
LatexCommand citep
key "scikit-learn"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow
\end_layout

\begin_layout Standard
TensorFlow
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://www.tensorflow.org
\end_layout

\end_inset

 is an open-source library developed by Google.
 It has become very popular because it provides APIs that facilitates machine
 learning.
 TensorFlow also has a faster compilation time than other deep learning
 libraries such as Keras and Touch.
 TensorFlow supports both CPU and GPU computing devices 
\begin_inset CommandInset citation
LatexCommand citep
key "medium-TF"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow Lite
\end_layout

\begin_layout Standard
TensorFlow Lite
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://www.tensorflow.org/lite
\end_layout

\end_inset

 is a set of tools to help developers run TensorFlow models on mobile, embedded,
 and IoT devices.
 It enables on-device machine learning inference with low latency and a
 small binary size 
\begin_inset CommandInset citation
LatexCommand citep
key "TF-TFLite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
TensorFlow Lite consists of two main components:
\end_layout

\begin_layout Itemize
The TensorFlow Lite interpreter, which runs specially optimized models on
 many different hardware types, including mobile phones, embedded Linux
 devices, and microcontrollers.
\end_layout

\begin_layout Itemize
The TensorFlow Lite converter, which converts TensorFlow models into an
 efficient form for use by the interpreter, and can introduce optimizations
 to improve binary size and performance.
\end_layout

\begin_layout Paragraph
Swift
\end_layout

\begin_layout Standard
Swift
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://swift.org
\end_layout

\end_inset

 is an open source programming language designed for macOS, iOS, watchOS,
 tvOS, and more.
 Swift already supports all Apple platforms and Linux, with community members
 actively working to port to even more platforms 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Swift"
literal "false"

\end_inset

.
 In 2010, Apple started developing Swift, a new programming language that
 would rival Objective-C in type safety, security, and hardware performance.
 Swift is more than 2.6x faster than Objective-C and more than 8.4x faster
 than Python.
 Swift 1.0 was released in September 2014 
\begin_inset CommandInset citation
LatexCommand citep
key "TechRep-Swift"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Xcode
\end_layout

\begin_layout Standard
Xcode
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://developer.apple.com/xcode/
\end_layout

\end_inset

 is a long-standing tool for app production and a well-known integrated
 development environment (IDE), enabling developers to write the code and
 compile apps that can be used on a variety of different devices and operating
 systems 
\begin_inset CommandInset citation
LatexCommand citep
key "AInsider-Xcode"
literal "false"

\end_inset

.
 It also includes a unified macOS SDK and all the frameworks, compilers,
 debuggers, and other tools you need to build apps that run natively on
 Apple Silicon 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Xcode"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
CocoaPods
\end_layout

\begin_layout Standard
CocoaPods
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://cocoapods.org
\end_layout

\end_inset

 is a dependency manager for Swift and Objective-C Cocoa projects.
 The dependencies of the projects just are specified in a single text file
 called Podfile.
 CocoaPods resolves dependencies between libraries, fetches the resulting
 source code, then links it together in an Xcode workspace to build a single
 project.
 
\begin_inset CommandInset citation
LatexCommand citep
key "CocoaPods"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Related Work
\end_layout

\begin_layout Standard
Over the last decade, there has been considerable progress in developing
 methodologies based in machine learning for many of Earth Science applications
 
\begin_inset CommandInset citation
LatexCommand citep
key "Lary2018"
literal "false"

\end_inset

.
 We present relevant articles related to the implementation of machine learning
 in the classifcation of images into the geoscience field.
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
In some of this articles I found about the 
\begin_inset Quotes eld
\end_inset

classification of rock lithology on geological surveys
\begin_inset Quotes erd
\end_inset

.
 However, I want to ask if it is a different type of rock classification
 than the used in this work.
 What do they mean by lithology?
\end_layout

\begin_layout Plain Layout
I searched in web but couldn´t understand.
 I just mentioned it in the articles below as rock classification.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Rock lithology image classification using machine learning
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019"
literal "false"

\end_inset

, Ran et al.
 also worked on the classification of rocks from images using machine learning.
 A total of 2,290 images with typical rock characteristics of six rock types
 (granite, limestone, conglomerate, sandstone, shale, mylonite) were used
 in the study.
 The images were labeled according to the clarity of the rock and then were
 cropped into 14,589 sample patches of 512 × 512 pixels compressed to 128
 × 128 pixels.
 60% of the patches of each type of rock were selected for the training
 dataset, 20% for the validation dataset, and 20% for the testing dataset.
 Finally, they proposed a deep CNN model that was compared with four machine
 learning models: SVM, AlexNet, GoogleLeNet Inception v3, and VGGNet-16.
 The proposed model achieved the highest overall accuracy of 97.76% compared
 with the other models.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Cheng2017"
literal "false"

\end_inset

, Cheng and Guo proposed a deep CNN to identify the rock granularity in
 images under three color spaces.
 The dataset contained 4,200 RGB images of feldspar sandstone rocks collected
 from an oil field in Ordos and divided into three types: coarse, medium
 granular, and fine feldspar sandstone.
 The images were normalized to 224 × 224 pixels and converted to YCbCr and
 HSV color spaces.
 The proposed CNN was a 6-layer structure: 4 convoluted layers with ReLU
 as the activation function and 2 fully connected layers with Softmax as
 the classifier.
 The model was trained for each color space with 75% of the experimental
 data, a batch size of 100, and different kernel sizes and learning rates.
 The lowest error rates were obtained with a learning rate of 0.0005, the
 kernel sizes of 11, 5, 3, and 3 for each convolutional layer respectively,
 and the cross-validation for HSV color space.
 In RGB color space, the classification accuracy achieved 98.5%.
\end_layout

\begin_layout Subsubsection
Rock classification with machine learning on Android devices
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020"
literal "false"

\end_inset

, Fan et al.
 created a method for rock lithology recognition on Android devices based
 on two lightweight CNNs.
 A total of 3,208 images taken by a smartphone camera were selected from
 the China Geological Survey dataset.
 The images of 28 rock categories were reduced to 214 × 214 pixels and the
 80% were used to train two CNNs pretrained with ImageNet dataset based
 on MobileNet and SqueezeNet models.
 The achieved occupation sizes were 19.6 M and 36.8 M for MobileNet and SqueezeNet
, and 232.7 M for a heavyweight ResNet50 model built to compare the models.
 SqueezeNet was almost two times faster than MobileNet, and 7 times faster
 than ResNet50.
 A rock recognition software based on the trained models was developed for
 Android devices.
 The results for SqueezeNet and MobileNet on Android smartphones were as
 follows: the file sizes of 9.2 MB and 17.6 MB, the execution time from 736
 to 366 and 1,218 to 523 milliseconds, and the recognition accuracies of
 94.55% and 93.27%.
\end_layout

\begin_layout Standard
Also in 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020a"
literal "false"

\end_inset

, Fan et al.
 improved their work using a model based on ShuffleNet for quick and accurate
 rock lithology recognition with smartphones.
 A total of 3,795 images were taken to 30 different kinds of rocks collected
 from multiple locations in East China.
 The proposed model was trained using 80% of the dataset, 3,600 iteration
 steps, a learning rate of 0.008, and the parameters imported by the transfer
 learning method from ShuffleNet model pretrained with the ImageNet dataset.
 ShuffleNet occupied a space of 18.2M and was compared with MobileNet, SqueezeNet
, and ResNet50 that occupied a space of 34.5M, 25M, and 219.4M respectively.
 An Android application was created using the models and run on three Android
 smartphones (Huawei, Samsung, and Oppo).
 The average recognition time of ShuffleNet for a single rock image was
 786 milliseconds, the reached accuracy was 97.65% in the verification data
 set of PC and 95.30% on the test data set of the smartphones.
\end_layout

\begin_layout Standard
In [], the authors worked on the automatic classification of plutonic rocks
 in Android devices.
 The dataset contained 71 images of diorite, gabbro, granite, granodiorite,
 monzodiorite, and tonalite which classification was based on petrographic
 analysis of Cretaceous granitoids collected from Peru.
 To increase the number of images, a new dataset of 846 patches from around
 450 × 700 to 900 × 1000 pixels was generated from the first dataset.
 A deep neural network was created with 4-layer structure: two convolutional,
 and two fully connected layers.
 After each convolutional layer it was a max pooling layer of 2×2 size,
 and a flatten and a dropout layers before the fisrt and second fully conected
 layers respectively.
 Several combinations of the rock classes were trained with 50% of the image
 patches, 100 epochs and a batch size of 32.
 The best combination was with four classes of plutonic rocks (gabbro, diorite,
 granite and granodiorite) achieving an accuracy of 95%, an average precision
 of 96%, an average recall of 95%, and an average F1-score of 95%.
 Finally, an Android application was developed using the proposed model
 trained with the best combination of rocks.
 The application evaluation results were: 70% for gabbro, 28.5% for diorite,
 100% for granodiorite, and 28.5% for granite.
\end_layout

\begin_layout Subsubsection
Mineral images recognition applying machine learning and feature extraction
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset

, Zhang et al.
 worked on the intelligent identification for rock-mineral images using
 ensemble machine learning algorithms (model stacking).
 A total of 481 images of four minerals (K-feldspar, perthite, plagioclase,
 and quartz) were obtained with the camera on the top of a microscope.
 The target RGB images were cropped to cover the minerals and then processed
 to be 299 × 299 pixels.
 A deep learning model based on Inception-v3 was adopted to extract high-level
 features (such as chromatic aberration and texture) from the images and
 train the algorithms of LR, SVM, KNN, Random Forest (RF), Multilayer Perceptron
 (MLP), and Gaussian Naive Bayes (GNB).
 LR, SVM, and MLP had a significant effect on extracted features, with higher
 accuracy (90.0%, 90.6%, and 89.8%) than the other models.
 The new features generated by this three models were employed for the model
 stacking in a new instance of LR.
 The stacking model showed a better performance than the single models,
 with an accuracy of 90.9%.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset

, Maitre et al.
 worked on the automated recognition of mineral grains based on supervised
 machine learning.
 A large mosaic RGB image was constructed with several views of a sample
 surface taken with a stereo-zoom binocular microscope.
 The sample surface contained grains of 27 different mineral species (plagioclas
e, augite, background, hypersthene, ilmenite, magnetite, titanite, hornblende,
 etc.) and was scanned with an automated Scanning Electron Microscopy (SEM)
 that assigned to each grain a mineral specie based on its chemical signature.
 Both images were divided in 3,192 sub-images of 600 × 600 pixels.
 To label the grains of the mosaic image, the simple linear iterative clustering
 (SLIC) algorithm was applied for superpixel segmentation to match each
 superpixel of the mosaic's sub-images with the superpixels of the SEM's
 scan sub-images.
 From the computed RGB superpixel histograms, the color intensity (quantile)
 and peak intensity (ratio between the number of pixels in the first and
 second maximum bins to total number of pixels) were extracted as features
 for each superpixels.
 KNN, RF, and Classification and Regression Trees (CART) algorithms were
 trained with 70% of the extracted features, and tested with the other 30%
 using the kappa statistics, precision, recall, and f1-score indicators.
 The RF algorithm gave the best results with a global accuracy of 89%.
\end_layout

\begin_layout Subsubsection
Comparison of the articles
\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Comparison-table-of"
plural "false"
caps "false"
noprefix "false"

\end_inset

 illustrates the comparison of the articles previously described.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement p
wide true
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison table of the articles described in the related work 
\begin_inset CommandInset label
LatexCommand label
name "tab:Comparison-table-of"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="8">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="4em">
<column alignment="center" valignment="middle" width="2.5em">
<column alignment="center" valignment="middle" width="9.4em">
<column alignment="center" valignment="middle" width="6.3em">
<column alignment="center" valignment="middle" width="8.3em">
<column alignment="center" valignment="middle" width="4.4em">
<column alignment="center" valignment="middle" width="5em">
<column alignment="center" valignment="middle" width="11em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Author
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Year
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dataset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Algorithm of extraction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dataset for training
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Best trained model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Results
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Zhang et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell mroffset="10cm" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
481 images of four minerals (K-feldspar, perthite, plagioclase, and quartz)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Inception-v3 CNN model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
High-level features (such as chromatic aberration and texture)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
90% of extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stacking model (LR, SVM, and MLP)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 90.9%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maitre et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,192 sub-images of the view taken to a surface with 27 mineral grains species
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simple Linear Iterative Clustering (SLIC) algorithm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Color intensity and Peak intensity of computed histograms from superpixels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70% of extracted features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random Forest (RF)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 89%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ran et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2019
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14,589 patches from 2,290 images of six rock types (granite, limestone,
 conglomerate, sandstone, shale, mylonite)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60% of the patches
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3-layer structure CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 97.76%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cheng and Guo 
\begin_inset CommandInset citation
LatexCommand citep
key "Cheng2017"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2017
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,200 images of three feldspar sandstones rock types (coarse, medium granular,
 and fine)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
75% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6-layer structure CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 98.5%
\end_layout

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fan et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2020
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,208 images of 28 rock lithology categories
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SqueezeNet and MobileNet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Android application accuracies: 94.55% and 93.27%
\end_layout

\begin_layout Plain Layout
File sizes: 9.2 MB and 17.6 MB
\end_layout

\begin_layout Plain Layout
Execution times: 736 to 366 and 1,218 to 523 millisecond
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fan et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020a"
literal "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2020
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,795 images of 30 different rock types
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80% of the images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ShuffleNet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Android application accuracy: 97.65%
\end_layout

\begin_layout Plain Layout
Occupation space on PC: 18.2M
\end_layout

\begin_layout Plain Layout
Classification time: 786 millisecond
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E.
 Vázquez and H.
 Alférez []
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2021
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
846 patches from 71 images of six plutonic rock types (diorite, gabbro,
 granite, granodiorite, monzodiorite, and tonalite)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50% of the patches
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-layer structure CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model accuracy: 95%
\end_layout

\begin_layout Plain Layout
Android application accuracy results: 70% for gabbro, 28.5% for diorite,
 100% for granodiorite, and 28.5% for granite
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As evidenced in these articles, machine learning has been an accurate way
 for image classification in the field of geosciences.
 Feature extraction was applied in 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang2019"
literal "false"

\end_inset

 before the training of several supervised machine learning models to classify
 mineral samples.
 These articles showed their higher accuracies from around 90%, however,
 the number of extracted features per instance used for training was even
 too large compared with the 16 extrected features per image presented in
 this research.
\end_layout

\begin_layout Standard
Four articles 
\begin_inset CommandInset citation
LatexCommand citep
key "Ran2019,Cheng2017,Fan2020,Fan2020a"
literal "false"

\end_inset

 introduce the comparison of different CNN model structures to analyze the
 performance of these models for rock lithology classification using all
 the image features rather than extracted features.
 Although these models showed great results in their evaluations, all of
 them were trained with diverse types of rocks compared to the classification
 of only plutonic type rocks made in this work.
 This type of classification becomes more difficult because the rocks of
 a same type have very similar characteristics.
\end_layout

\begin_layout Standard
The articles including the deployment of the created models on android mobile
 aplications for rock lithology classification are
\begin_inset CommandInset citation
LatexCommand citep
key "Fan2020,Fan2020a"
literal "false"

\end_inset

.
 Also in [], Elías L.
 Vázquez and Germán H.
 Alférez made a previos work using the same dataset presented in our study
 to deploy their proposed model on an Android application for the automatic
 classification of plutonic rocks.
 However, this model was trained with all the image features instead of
 selecting just the dominant colors.
 There are no works presenting the evaluation results of the deployment
 of machine learning on iOS devices.
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Subsection
Methodology
\end_layout

\begin_layout Standard
This section describes the steps followed in this research work.
\end_layout

\begin_layout Subsubsection
Data description
\end_layout

\begin_layout Standard
The original images were provided by the Department of Earth and Biological
 Sciences at Loma Linda University.
 The dataset contains images of four classes of plutonic rocks: granite,
 granodiorite, gabbro, and diorite with a total of 81 images.
 The images used in the following experiments are available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/tree/main/Rock-images
\end_layout

\end_inset

.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Number-of-images"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the number of images per class.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Number of images per class 
\begin_inset CommandInset label
LatexCommand label
name "tab:Number-of-images"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="7em">
<column alignment="center" valignment="middle" width="8.3em">
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Number of images
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Total of images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
81
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Data preparation
\end_layout

\begin_layout Standard
In this step the images were processed to extract the color values from
 image pixels.
 The notebook with the source code for data preparation is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
http://bit.ly/3pyh3JL
\end_layout

\end_inset

.
 In listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:load-images-from-folder"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the 
\begin_inset Quotes eld
\end_inset

load_images_from_folder
\begin_inset Quotes erd
\end_inset

 function in lines 6 to 18, is declared to process all the files with image
 extension ('.png', ’.jpg’, ’.jpeg’) from a folder.
 After processing an image, the color of each pixel in it is represented
 by the RGB color space.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/load images from folder.txt"
lstparams "language=Python,caption={Function to load images from a folder},label={list:load-images-from-folder}"

\end_inset


\end_layout

\begin_layout Standard
In listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:load-images-from-directory"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the 
\begin_inset Quotes eld
\end_inset

load_images_from_directory
\begin_inset Quotes erd
\end_inset

 function is declared from lines 1 to 13 to iterate the subfolders contained
 in a main directory and process the images in them with the support of
 the previous declared 
\begin_inset Quotes eld
\end_inset

load_images_from_folder
\begin_inset Quotes erd
\end_inset

 function.
 It also assigns labels to the processed images according to the name of
 the folder in which they are as shown in line 9.
 For that reason, it is important to group the images in subfolders based
 on their rock class name.
\end_layout

\begin_layout Standard
Finally, in line 17, the rock images in the folder declared in line 15 are
 processed in RGB format.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/load images from directory.txt"
lstparams "language=Python,caption={Function to load images from a directory},label={list:load-images-from-directory}"

\end_inset


\end_layout

\begin_layout Subsubsection
Determining the best k number of color clusters
\end_layout

\begin_layout Standard
The k-means algorithm was used to extract the dominant colors from the images.
 First, it was necessary to calculate the optimal number of clusters (groups
 of pixels with similar color) to use in the algorithm.
 In listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:elbow-method"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the Elbow method was used for this purpose.
 This method consists of iterating in a range of possible cluster numbers
 to use in the k-means algorithm and determine the best number.
 The possible cluster numbers are from 2 to 20 as shown in line 4 and then
 are iterated in lines 6 to 9.
 At each iteration each cluster number is selected as the k number of the
 k-means algorithm and trained in line 8 with an instance of the images
 processed at the previous step.
 In line 9 the score obtained in k-means at each iteration is appended to
 a list of scores.
 From lines 11 to 16 the k-means scores are plotted with their respective
 k numbers.
 The number at the elbow of the plot is the best k number of clusters, that
 number is 4 in this experiment 
\shape italic
\emph on
(see Fig.
 
\shape default
\emph default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Elbow-method"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/elbow method.txt"
lstparams "language=Python,caption={Determining the best number of clusters with the Elbow method},label={list:elbow-method}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Elbow curve.png
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Elbow method showing the optimal k number of clusters 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-Elbow-method"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Color extraction
\end_layout

\begin_layout Standard
This step describes the process for extracting the dominant colors from
 the rock images.
\end_layout

\begin_layout Standard
In listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:get-dominant-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the 
\begin_inset Quotes eld
\end_inset

get_dominant_colors
\begin_inset Quotes erd
\end_inset

 function receives the pixel values of an image to train the k-means algorithm
 with 4 clusters, which is the number of clusters selected in the previous
 step.
 In line 6, k-means works by separating the pixels of that image into k
 groups (clusters) of similarly coloured pixels.
 The colors at each cluster center reflect the average of the attributes
 of all members of a cluster.
 The percentage of a cluster calculated in lines 8 to 10 is the number of
 pixels within that cluster.
 From lines 14 to 18, the center color in each cluster and its percentage
 is added to the features list returned in line 20.
 This list has sixteen elements: the four main colors in RGB (red, green,
 and blue) color format and their percentage (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Dominant-colors-and"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/get dominant colors.txt"
lstparams "language=Python,caption={Function to extract the dominant colors from a single image},label={list:get-dominant-colors}"

\end_inset


\end_layout

\begin_layout Standard
In listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:iterate-to-extract-colors"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the processed data of the rock images is iterated to extract the dominant
 colors with the previous explained 
\begin_inset Quotes eld
\end_inset

get_dominant_colors
\begin_inset Quotes erd
\end_inset

 function of listing 4.
 These colors are added to a new array called 
\begin_inset Quotes eld
\end_inset

extracted_colors
\begin_inset Quotes erd
\end_inset

.
 In line 6, the extracted colors are saved together with their respective
 rock label in a CSV file.
 This file is used in the next step to train the machine learning algorithms.
 The CSV is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/colors.csv
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/Iterate in data to extract colors.txt"
lstparams "language=Python,caption={Iterate original data to extract dominant colors},label={list:iterate-to-extract-colors}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Color extraction.png
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Dominant colors and average color of sample images 
\begin_inset CommandInset label
LatexCommand label
name "fig:Dominant-colors-and"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Training of the different algorithms with the extracted dominant colors
\end_layout

\begin_layout Standard
Five machine learning models were trained for this experiment: LR, KNN,
 DT, SVM, and a CNN.
 The notebook showing the training and validation process of the generated
 models is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Color-extraction/blob/main/ML-training.ipynb
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
First, in listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:split-data"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the main dominant colors data is loaded from the CSV file of the previous
 step into x and y Numpy arrays and splitted into train, test, and validation
 sets.
 The 
\begin_inset Quotes eld
\end_inset

train_test_split
\begin_inset Quotes erd
\end_inset

 function was used in line 9 to split the data and get a validation set
 with 20% of the data.
 In line 10, the other 80% of the split in line 9 was splitted again in
 20% for the test set and 80% for the train set.
 Three sets were used in the experiments: 20% for validation, 16% for testing,
 and 64% for training from the total of the data.
 The train set composed for 
\begin_inset Quotes eld
\end_inset

xtrain
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

ytrain
\begin_inset Quotes erd
\end_inset

 of the line 10 was used to train all the algorithms.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/split data.txt"
lstparams "language=Python,caption={Splitting the data in train and test},label={list:split-data}"

\end_inset


\end_layout

\begin_layout Standard
The following parameters were used to set the models as shown in table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:The-parameters-set"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The parameters set in the models 
\begin_inset CommandInset label
LatexCommand label
name "tab:The-parameters-set"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="3.5em">
<column alignment="center" valignment="middle" width="6.3em">
<column alignment="center" valignment="middle" width="11em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
L-BFGS
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
KNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N_neighbors
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Class_weights
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Balanced
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SVM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kernel
\end_layout

\begin_layout Plain Layout
Gamma
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RBF
\end_layout

\begin_layout Plain Layout
Auto
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Loss
\end_layout

\begin_layout Plain Layout
Optimizer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Categorical_crossentropy
\end_layout

\begin_layout Plain Layout
Adam
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The L-BFGS (Limited-memory Broyden–Fletcher–Goldfarb–Shanno) solver is one
 of the quasi-Newton methods that approximate the BFGS algorithm, which
 utilizes a limited amount of computer memory.
 The solver's methodology starts iterating at a random point (xt) to calculate
 the minimum from the second derivate of the original function at that point
 and assign it to a new point (xt+1).
 The new point will become the starting point for the next iteration.
 In this way, L-BFGS quickly converges on the solution 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The number of neighbors used in KNN represents the neighbor samples analyzed
 from the dataset to classify a new sample into the class to which most
 of their neighbors belong.
\end_layout

\begin_layout Itemize
By utilizing class weights, we can increase the importance of a particular
 class during training.
 The balanced mode for class weight uses the values of the labels in the
 train set to automatically adjust the node weights inversely proportional
 to the class frequencies in the input data 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The Radial Basis Function (RBF) kernel is useful to eliminate the computational
 requirement of an algorithm.
 When it is used, the features need to be scaled and the gamma value is
 setting for 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The auto value in gamma paremeter of scikit learn is represented by 
\begin_inset Formula $1/numberOfFeatures$
\end_inset

.
 An small gamma will give you low bias and high variance solutions 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017,Scikit-SVC"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Categorical cross-entropy is the most diffused classification cost function,
 adopted by logistic regression and the majority of neural architectures.
 This convex function can be easily optimized using stochastic gradient
 descent techniques and is an excellent choice for classification problems
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonaccorso2018"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Adam (adaptive moment estimation) algorithm is an efficient optimization
 method that computes adaptive learning rates for each parameter to optimize
 the weights of the model 
\begin_inset CommandInset citation
LatexCommand citep
key "Dangeti2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Below, listing 
\begin_inset CommandInset ref
LatexCommand ref
reference "list:train-models"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the set and training process of the models.
 LR, KNN, DT, SVM, and CNN were set as listed in lines 3, 8, 13, 18, and
 36 and trained in lines 4, 9, 14, 19, and 37 respectively.
\end_layout

\begin_layout Standard
The CNN was compiled in line 36 with the categorical crossentropy loss function
 and the Adam optimizer.
 Also several numbers of epochs and batches were tried until the most optimal
 values were obtained as shown in its training at line 37.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train models.txt"
lstparams "language=Python,caption={Models training},label={list:train-models}"

\end_inset


\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:CNN-model-structure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 describes the CNN model structure used in this experiment\SpecialChar endofsentence

\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
CNN model structure 
\begin_inset CommandInset label
LatexCommand label
name "tab:CNN-model-structure"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="4">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="middle" width="6.8em">
<column alignment="center" valignment="middle" width="3.4em">
<column alignment="center" valignment="middle" width="4.7em">
<column alignment="center" valignment="middle" width="5em">
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Layer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kernel size
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Activation function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output shape
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Input features
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conv1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 × 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conv1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 × 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dropout (50%)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MaxPooling1D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 × 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flatten
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dense
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RELU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dense
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Softmax
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16 × 32
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Evaluation of the machine learning algorithms
\end_layout

\begin_layout Standard
Evaluating a model is a core part of building an effective machine learning
 project.
 For this purpose are used the following four metrics to evaluate the algorithms
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mishra2018"
literal "false"

\end_inset

:
\end_layout

\begin_layout Itemize
Accuracy is the ratio of number of correct predictions to the total number
 of input samples.
\begin_inset Formula 
\[
Accuracy=\frac{CorrectPredictions}{PredictionsMade}
\]

\end_inset


\end_layout

\begin_layout Itemize
Precision is the number of correct positive results divided by the number
 of positive results predicted by the classifier.
\begin_inset Formula 
\[
Precision=\frac{TP}{TP+FP}
\]

\end_inset


\end_layout

\begin_layout Itemize
Recall is the number of correct positive results divided by the number of
 all relevant samples (all samples that should have been identified as positive).
 
\begin_inset Formula 
\[
Recall=\frac{TP}{TP+FN}
\]

\end_inset


\end_layout

\begin_layout Itemize
F1-score is used to measure a test’s accuracy, the Harmonic Mean between
 precision and recall.
 It tells you how precise your classifier is (how many instances it classifies
 correctly), as well as how robust it is (it does not miss a significant
 number of instances).
\begin_inset Formula 
\[
F1=2*\frac{Precision*Recall}{Precision+Recall}
\]

\end_inset

The greater the F1-score, the better is the performance of our model.
\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-of-all"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the accuracy of all the trained algorithms evaluated with the test
 set of the previous step.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of all the algorithms in terms of accuracy 
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-of-all"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="middle" width="8.5em">
<column alignment="center" valignment="middle" width="4.6em">
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent

\series bold
Model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent

\series bold
Accuracy
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
Logistic Regression
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.29
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
KNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.82
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
Decision Trees
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.70
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
SVM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.41
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
\align left
CNN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\noindent
0.41
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Tables 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-of-Logistic"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Results-of-the"
plural "false"
caps "false"
noprefix "false"

\end_inset

 show the results of each model evaluation in terms of precision, recall
 and F1-score.
 The best results were obtained with the KNN model with the highest average
 values of 82% for accuracy, 84% for precision, 89% for recall, and 83%
 for f1-score.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Logistic Regression 
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-of-Logistic"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.7em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.86
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.84
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.83
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of K-Nearest Neighbors
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.7em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.86
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.84
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.83
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Decision Trees
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.7em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.62
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.71
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.62
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.75
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Support Vector Machine
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.7em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.67
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.54
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.39
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of the Convolutional Neural Network 
\begin_inset CommandInset label
LatexCommand label
name "tab:Results-of-the"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.7em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<column alignment="center" valignment="top" width="4.5em">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Precision
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Recall
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F1-score
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Granodiorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.42
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.56
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Gabbro
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.57
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left
Diorite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\align left

\series bold
Average
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.46
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.28
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Results
\end_layout

\begin_layout Standard
This section cover the creation process of a mobile application that classifies
 four types of plutonic rocks with the dominant colors extracted from images
 taken on iOS devices.
 
\end_layout

\begin_layout Standard
The KNN model was the model deployed in the iOS mobile application to make
 the classification on real-time.
 The Xcode IDE, the Xcode command-line tools, a valid Apple Developer ID,
 and the CocoaPods dependency manager were the main requeriments to develop
 it.
 The application is written mostly in Swift and uses the following two libraries
 for performing dominant colors extraction and image classification:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement t
wide true
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Workflow.png
	lyxscale 50
	width 85page%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Application workflow 
\begin_inset CommandInset label
LatexCommand label
name "fig:Application-workflow"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The DominantColor
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/indragiek/DominantColor
\end_layout

\end_inset

 dependency is an open source library written in Swift and created by Indragie
 Karunaratne.
 It finds the dominant colors of an image using the CIE LAB color space
 and the k-means clustering algorithm.
 In this project an adaptation of this library was implemented exporting
 the 7 main files from the repository into the application project.
\end_layout

\begin_layout Itemize
The TensorFlowLite Swift
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/swift
\end_layout

\end_inset

 library is TensorFlow's lightweight solution for Swift developers.
 It enables low-latency inference of on-device machine learning models with
 a small binary size and fast performance supporting hardware acceleration.
 For the application, TensorFlowLiteSwift pod name was added into the project's
 Podfile, and from command line the library was resolved into the Xcode
 project by the CocoaPods dependency manager.
\end_layout

\begin_layout Standard
Three source codes of iOS applications were taken from the TensorFlow Lite's
 repository on github as the example guides to built our application for
 rock classification:
\end_layout

\begin_layout Itemize
The image classification
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
http://bit.ly/3oSuxQK
\end_layout

\end_inset

 is an example application for TensorFlow Lite on iOS.
 It uses Image classification to continuously classify whatever it sees
 from the device's back camera, using a quantized MobileNet model.
 
\end_layout

\begin_layout Itemize
The image segmentation
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
http://bit.ly/3nJM6RD
\end_layout

\end_inset

 iOS sample aplication implements a state-of-art deep learning model for
 semantic image segmentation, where the goal is to assign semantic labels
 (e.g.
 person, dog, cat) to every pixel in the input image.
\end_layout

\begin_layout Itemize
The digit classifier
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
http://bit.ly/3srLkMx
\end_layout

\end_inset

 iOS sample application uses a digit classifier model built with TensorFlow
 2.0 (Keras API), and trained on MNIST to classify handwritten digits drawn
 in a sketch.
\end_layout

\begin_layout Standard
Shown below is the application process (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Application-workflow"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The source code of the application is available online
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
https://github.com/sarah-hs/Rock-Classifer-iOS
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Me falta describir el workflow de la aplicación
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Discussion
\end_layout

\begin_layout Standard
Five machine learning algorithms were trained with just the four dominant
 colors extracted from rock images.
 The best algorithm in this experiment was K-Nearest Neighbors with an accuracy
 of 82%.
 Its values for precision, recall, and F1 score were 84%, 89%, and 83%.
 After obtain the best suited algorithm for rock classification with dominant
 colors, an iOS mobile application was developed to classify rock images
 into four classes of plutonic rocks (granite, granodioorite, gabbro and
 diorite).
 This application also allows the user to visualize the dominant colors
 and the average color in new images and detect changes in rock colors.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Falta probar la applicación con nuevas muestras.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Conclusions and Future Work
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Newpage clearpage
\end_inset


\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "Rocks"

\end_inset


\end_layout

\end_body
\end_document
