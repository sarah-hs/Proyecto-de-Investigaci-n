import cv2, os
from PIL import Image, ImageOps
import numpy as np
from itertools import repeat

def load_images_from_folder(folder, size):
    images = []
    filenames = []
    for filename in os.listdir(folder):
        if(not filename.lower().endswith(('.png', '.jpg', '.jpeg', '.tiff', '.bmp', '.gif'))):
            print(filename, 'removed')
            continue
        img = Image.open(os.path.join(folder,filename))
        fit_and_resized_image = ImageOps.fit(img, size, Image.ANTIALIAS)
        img = np.array(fit_and_resized_image)
        img = img[...,:3]
        if img is not None:
            images.append(img)
            filenames.append(filename)
    return (images, filenames)

def load_images_from_directory(path, size):
    paths = os.listdir(path)
    x = []; y = []; files = [];
    for folder in paths:
        if(os.path.isfile(folder)):
            print(folder, 'removed')
            continue
        images, filenames = load_images_from_folder(os.path.join(path, folder), size)
        lbls = list(repeat(folder, len(images)))
        x.extend(images)
        y.extend(lbls)
        files.extend(filenames)
    return (x, y, files)