#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass IEEEtran
\begin_preamble
% for subfigures/subtables
\usepackage{titlesec}
\titlespacing{\subsubsection}{0pt}{0.6em}{0pt}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{diagbox}
\usepackage{array}
\end_preamble
\options journal
\use_default_options false
\begin_modules
graphicboxes
\end_modules
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding ascii
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 1
\bibtex_command bibtex
\index_command default
\float_placement tbh
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "Your Title"
\pdf_author "Your Name"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle false
\pdf_quoted_options "pdfpagelayout=OneColumn, pdfnewwindow=true, pdfstartview=XYZ, plainpages=false"
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine biblatex-natbib
\cite_engine_type numerical
\biblio_style jurabib
\biblatex_bibstyle ieee
\biblatex_citestyle numeric
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 2
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align left
\begin_inset Graphics
	filename Images/Logo_UM.png
	lyxscale 7
	width 2.5cm
	height 2.5cm
	keepAspectRatio

\end_inset


\begin_inset space \hspace{}
\length 12cm
\end_inset


\begin_inset Graphics
	filename Images/Logo_FIT.png
	lyxscale 75
	width 2.5cm
	height 2.5cm
	keepAspectRatio

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size huge
Universidad de Montemorelos
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Facultad de Ingeniería y Tecnología
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Ingeniería en Sistemas Computacionales
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.6cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size huge
Automatic classification of plutonic rocks with machine learning applied
 to extracted colors on iOS devices
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.6cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Sarah Hernández Serrano
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
1170469
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.6cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Asesor: Dr.
 Germán Harvey Alférez Salinas
\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 1.6cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Montemorelos, Nuevo León, México
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
00 de mayo de 2021
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
\begin_inset VSpace 7cm
\end_inset


\end_layout

\begin_layout Abstract
The classification of different rocks can provide us with important information
 about the conditions under they formed and the tectonic environment.
 Color is a key property for rock classification, however, it is difficult
 to describe because a color may be named differently by different persons.
 Rock classification equipment is very expensive and time consuming, in
 addition, it is necesssary to have a great knowledge about the rocks to
 classify them which makes it difficult for amateurs.
 A mobile application offers the flexibility to carry out the classification
 of rocks on real time with no need of having a wide knowledge on the field.
 There are two main contributions of this project.
 The first one is an iOS application that uses machine learning to classify
 plutonic rocks into granite, granodiorite, gabbro, and diorite types.
 In order to use the best suited machine learning algorithm in the application,
 the effectiveness of the Logistic Regression, K-Nearest Neighbors, Decision
 Trees, Support Vector Machine, and Convolutional Neural Network algorithms
 is compared.
 The training of machine learning algorithms can involve a lot of computational
 processing and time due to the large amount of features that an image posses,
 for that reason the second contribution is to reduce the number of features
 in rock images extracting just the four main colors to train the algorithms.
 To this end, the k-means clustering method was used.
 The evaluation results of the algorithms are the following: for Logistic
 Regression 29% of accuracy, 84% of precision, 89% of recall, and 83% of
 F1-score; for K-Nearest Neighbors 82% of accuracy, 84% of precision, 89%
 of recall, and 83% of F1-score; for Decision Trees 70% of accuracy, 82%
 of precision, 73% of recall, and 75% of F1-score; for Support Vector Machine
 41% of accuracy, 33% of precision, 54% of recall, and 39% of F1-score;
 for Convolutional Neural Network 41% of accuracy, 20% of precision, 46%
 of recall, and 28% of F1-score.
 The best results were achieved with K-Nearest Neighbors algorithm.
\end_layout

\begin_layout Keywords
Machine Learning, Color Extraction, iOS Devices, Geology, Rock Classification,
 Features Reduction, Dominant Colors, K-means Clustering, Logistic Regression,
 K-Nearest Neighbors, Support Vector Machine, Convolutional Neural Network,
 Decision Trees.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{titlepage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Title
Automatic classification of plutonic rocks with machine learning applied
 to extracted colors on iOS devices
\end_layout

\begin_layout Author
Sarah
\begin_inset space ~
\end_inset

Hernández
\begin_inset space ~
\end_inset

and
\begin_inset space ~
\end_inset

Germán
\begin_inset space ~
\end_inset

H.
\begin_inset space ~
\end_inset

Alférez
\begin_inset Foot
status open

\begin_layout Plain Layout
Sarah
\begin_inset space ~
\end_inset

Hernández is a computer science engineering student at the School of Engineering
 and Technology of Montemorelos University, Nuevo León, Mexico, e-mail:
 
\begin_inset CommandInset href
LatexCommand href
target "1170469@alumno.um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Germán H.
 Alferez, Ph.D., is the director of the Institute of Data Science and professor
 at the School of Engineering and Technology of Montemorelos University,
 Nuevo León, Mexico, e-mail: 
\begin_inset CommandInset href
LatexCommand href
target "harveyalferez@um.edu.mx"
type "mailto:"
literal "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Special Paper Notice
School of Engineering and Technology, Montemorelos University, Mexico
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Subsection
Background
\end_layout

\begin_layout Standard
\begin_inset Flex Paragraph Start
status open

\begin_layout Plain Layout
\begin_inset Argument 1
status open

\begin_layout Plain Layout
I
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
The 
\series bold

\backslash
IEEEPARstart
\series default
 command is needed in the first paragraph of the document.
\end_layout

\end_inset

 gneous rocks are one of the three main types of rocks in the world and
 also the most common.
 They have a wide variety of uses, one important use is as stone for buildings
 and statues 
\begin_inset CommandInset citation
LatexCommand citep
key "NGS-2019,Lumen-Schulte"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Plutonic rocks are a type of igneous rock formed when magma in the middle
 of the volcano cools and solidifies below the Earth’s surface 
\begin_inset CommandInset citation
LatexCommand citep
key "Study-2013"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
The classification of different igneous rocks can provide us with important
 information about the conditions under which they formed.
 They can also tell us much about the tectonic environment, given that they
 are closely linked to the convection of tectonic plates.
 Their mineral and chemical makeup can be used to learn about the composition,
 temperature and pressure that exists within the Earth’s mantle 
\begin_inset CommandInset citation
LatexCommand citep
key "Williams-2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Rock color is an attribute of visual perception that can be described by
 color names.
 Color changes in rocks may indicate changes in the rock’s mineral assemblage,
 texture, organic carbon content (shales), or other properties 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
 That is why color is a key property for rock classification.
\end_layout

\begin_layout Standard
Machine learning, a branch of artificial intelligence, is becoming an appealing
 tool in various fields of earth sciences, especially in predictions and
 resources estimation 
\begin_inset CommandInset citation
LatexCommand citep
key "Cate2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
This research work uses machine learning to extract the main dominant colors
 from rock images and also classify with them new rocks into four types
 of plutonic rocks: granite, granodiorite, gabbro and diorite.
\end_layout

\begin_layout Subsection
Problem Statement
\end_layout

\begin_layout Standard
Igneous rock classification equipment is very expensive and time consuming,
 in addition, it is necesssary to have a great knowledge about the properties
 of rocks to classify them which makes it difficult for amateurs – people
 who are inexperienced in rocks.
\end_layout

\begin_layout Standard
Color property is difficult to describe because perceived colors in rocks
 also depend on the observer's experience with similar observations; so
 a color may often be named differently by different persons 
\begin_inset CommandInset citation
LatexCommand citep
key "NRCS-2012"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Justification
\end_layout

\begin_layout Standard
A mobile application that uses machine learning for the automatic classification
 of plutonic rocks offers the flexibility to carry out the classification
 of rocks on real time.
 Such solution could be an alternative to expensive traditional methods
 for rock classification and can be used by those who are beginning into
 the field of rocks.
\end_layout

\begin_layout Standard
Extracting color from rock images allows geologists to more accurately detect
 color changes in rocks.
 In addition, the machine learning algorithms used within the application
 can be trained with the extracted colors to reduce the number of features
 in the images and consequently decrease the time and computational processing
 during training 
\begin_inset CommandInset citation
LatexCommand citep
key "Sen-2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Objectives
\end_layout

\begin_layout Standard
The main objective is to create an iOS application that uses machine learning
 to extract the dominant colors from images and classify with them plutonic
 rocks.
 This objective can be achieved with the following sub-objectives:
\end_layout

\begin_layout Itemize
Determine the best k number of clusters to use in the k-means clustering
 machine learning method to extract the dominant colors from rock images.
\end_layout

\begin_layout Itemize
Extracted colors and their percentages will be used as an input to train
 the following machine learning algorithms: Logistic regression, K-Nearest
 Neighbors, Decision Trees, Support Vector Machine, and Convolutional Neural
 Network.
\end_layout

\begin_layout Itemize
Validate the algorithms to get the best suited algorithm for the mobile
 application.
\end_layout

\begin_layout Itemize
Test the effectiveness of the best algorithm with new color data from rock
 images.
\end_layout

\begin_layout Itemize
Implement the best suited machine learning algorithm in the iOS application.
\end_layout

\begin_layout Subsection
Hypothesis
\end_layout

\begin_layout Standard
It is possible to extract the dominant colors from rock images with the
 implementation of k-means machine learning algorithm.
 Also it is possible to train well a machine learning algorithm with just
 the extracted colors and classify with them new rock data into granite,
 granodiorite, gabbro, and diorite plutonic rock types.
\end_layout

\begin_layout Section
Theoretical Foundation
\end_layout

\begin_layout Subsection
Underpinnings of our Approach
\end_layout

\begin_layout Standard
Our approach is based on the following concepts 
\shape italic
\emph on
(see Fig.
 1
\shape default
\emph default
).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Images/Map of concepts.png
	lyxscale 20
	width 100col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Underpinnings of our approach
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Plutonic rocks
\end_layout

\begin_layout Standard
Also called intrusive rocks.
 They have a coarse grained texture and form when magma is trapped deep
 inside the Earth.
 Some of the magma may feed volcanoes on the Earth's surface, but most remains
 trapped below, where it cools very slowly over many thousands or millions
 of years until it solidifies 
\begin_inset CommandInset citation
LatexCommand citep
key "USGS-Igneous"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
This project analyze the following four types of plutonic rocks:
\end_layout

\begin_layout Paragraph
Granite
\end_layout

\begin_layout Standard
Is rich in quartz (a pink rock crystal 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Quartz"
literal "false"

\end_inset

) and feldspar; it is the most common plutonic rock of the Earth’s crust,
 forming by the cooling of magma at depth.
 The principal constituent of granite is feldspar 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Granite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Granodiorite
\end_layout

\begin_layout Standard
It is among the most abundant intrusive igneous rocks.
 The mode of formation, its physical appearance, texture, and mineralic
 composition are much like those of granite.
 Granodiorite is darker in colour and is distinguished from granite by its
 having more plagioclase feldspar than orthoclase feldspar 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Granodiorite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Gabbro
\end_layout

\begin_layout Standard
Is exceedingly variable in mineralogy and composition, dark in colour, and
 often intimately associated with magnetite (iron) and ilmenite (titanium)
 mineralizations.
 Gabbros are found widely on the Earth and on the Moon as well 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Gabbro"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Diorite
\end_layout

\begin_layout Standard
Has about the same structural properties as granite but darker colour and
 more limited supply.
 Commonly is composed of about two-thirds plagioclase feldspar and one-third
 dark-coloured minerals, such as hornblende or biotite.
 The presence of sodium-rich feldspar, oligoclase or andesine, in contrast
 to calcium-rich plagioclase, labradorite or bytownite, is the main distinction
 between diorite and gabbro 
\begin_inset CommandInset citation
LatexCommand citep
key "Britannica-Diorite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Machine Learning
\end_layout

\begin_layout Standard
It is a branch of artificial intelligence based on the idea that systems
 can learn from data, identify patterns and make decisions with minimal
 human intervention 
\begin_inset CommandInset citation
LatexCommand citep
key "SAS-ML"
literal "false"

\end_inset

.
 Machine learning algorithms use statistics to find patterns in massive
 amounts of data 
\begin_inset CommandInset citation
LatexCommand citep
key "TechRev-ML"
literal "false"

\end_inset

.
 There are two main types of machine learning algorithms:
\end_layout

\begin_layout Paragraph
Supervised learning
\end_layout

\begin_layout Standard
Are algorithms that consist in generate a function which maps input features
 to desired output labels.
 Given a set of features the labels are to be predicted.
 An algorithm will be trained until it achieves a desired level of accuracy
 
\begin_inset CommandInset citation
LatexCommand citep
key "Vidhya-ML"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Logistic Regression algorithm is almost used for binary classification problems
 (problems with two labels) 
\begin_inset CommandInset citation
LatexCommand citep
key "TowardsDS-LogisticR"
literal "false"

\end_inset

.
 It is named for the function used at the core of the method, the logistic
 function, was developed by statisticians to describe properties of population
 growth in ecology, rising quickly and maxing out at the carrying capacity
 of the environment 
\begin_inset CommandInset citation
LatexCommand citep
key "Brownlee-2016"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
K-Nearest Neighbors is an algorithm in which its priniciple is to find a
 predefined number of training samples closest in distance to the new point,
 and predict the label from these.
 Despite its simplicity, nearest neighbors has been successful in a large
 number of classification and regression problems, including handwritten
 digits and satellite image scenes.
 Being a non-parametric method, it is often successful in classification
 situations where the decision boundary is very irregular 
\begin_inset CommandInset citation
LatexCommand citep
key "sklearn-KNN"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Decision Trees algorithm consists of split nodes and leaf nodes.
 Each split node performs a split decision and routes a data sample either
 to the left or the right child node 
\begin_inset CommandInset citation
LatexCommand citep
key "REINDERS201965"
literal "false"

\end_inset

.
 In the tree structures, leaves represent the labels, nonleaf nodes are
 the input features, and branches represent conjunctions of features that
 lead to the classifications 
\begin_inset CommandInset citation
LatexCommand citep
key "TAN2015493"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Support Vector Machine algorithm is formally defined by a separating hyperplane.
 In other words, given labeled training data, the algorithm outputs an optimal
 hyperplane which categorizes new examples.
 In two dimentional space this hyperplane is a line dividing a plane in
 two parts where in each class lay in either side 
\begin_inset CommandInset citation
LatexCommand citep
key "medium-SVM"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Convolutional Neural Network is a computational model that has one or more
 convolutional layers and are used mainly for image processing, classification,
 segmentation and also for other auto correlated data.
 A convolution is essentially sliding a filter over the input.
 Each pixel is multiplied by the corresponding value in the filter, then
 the result is summed up for a single value for simplicity representing
 a grid cell, like a pixel, in the output map 
\begin_inset CommandInset citation
LatexCommand citep
key "TowardsDS-CNN"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Unsupervised learning
\end_layout

\begin_layout Standard
These algorithms are designed to identify patterns in the structure of the
 data.
 Unsupervised learning is used for clustering population in different groups
 with similar characteristics 
\begin_inset CommandInset citation
LatexCommand citep
key "Vidhya-ML,medium-ML"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
K-means algorithm works by taking data points as input and grouping them
 into k clusters.
 This process of grouping is the training phase of the learning algorithm.
 The result would be a model that takes a data sample as input and returns
 the cluster that the new data point belongs to, according the training
 that the model went through 
\begin_inset CommandInset citation
LatexCommand citep
key "AlMasri-2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Dominant colors
\end_layout

\begin_layout Standard
The dominant colors refers to the principal colors presented in an image.
 This colors are selected grouping the image pixels in a certain number
 of groups according to their color.
 The average color of each group are the dominant colors and the number
 of pixels in each group are the dominant colors´ percentage.
\end_layout

\begin_layout Subsubsection
Underlying technologies
\end_layout

\begin_layout Paragraph
Tensorflow
\end_layout

\begin_layout Standard
TensorFlow
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
TensorFlow
\end_layout

\end_inset

 is an open-source library developed by Google and has become very popular
 with Machine Learning.
 TensorFlow offers APIs that facilitates Machine Learning.
 TensorFlow also has a faster compilation time than other Deep Learning
 libraries such as Keras and Touch.
 TensorFlow supports both CPU and GPU computing devices 
\begin_inset CommandInset citation
LatexCommand citep
key "medium-TF"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Tensorflow Lite
\end_layout

\begin_layout Standard
TensorFlow Lite is a set of tools to help developers run TensorFlow models
 on mobile, embedded, and IoT devices.
 It enables on-device machine learning inference with low latency and a
 small binary size 
\begin_inset CommandInset citation
LatexCommand citep
key "TF-TFLite"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
TensorFlow Lite consists of two main components:
\end_layout

\begin_layout Itemize
The TensorFlow Lite interpreter, which runs specially optimized models on
 many different hardware types, including mobile phones, embedded Linux
 devices, and microcontrollers.
\end_layout

\begin_layout Itemize
The TensorFlow Lite converter, which converts TensorFlow models into an
 efficient form for use by the interpreter, and can introduce optimizations
 to improve binary size and performance.
\end_layout

\begin_layout Paragraph
Swift
\end_layout

\begin_layout Standard
Swift is an open source programming language designed for macOS, iOS, watchOS,
 tvOS and beyond.
 Swift already supports all Apple platforms and Linux, with community members
 actively working to port to even more platforms 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Swift"
literal "false"

\end_inset

.
 In 2010, Apple started developing Swift, a new programming language that
 would rival Objective-C in a few areas--specifically, type safety, security,
 and better on-hardware performance.
 Swift is more than 2.6x faster than Objective-C and more than 8.4x faster
 than Python.
 Swift 1.0 was released in September 2014 
\begin_inset CommandInset citation
LatexCommand citep
key "TechRep-Swift"
literal "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
Xcode
\end_layout

\begin_layout Standard
A long-standing tool for app production, Xcode is a well-known integrated
 development environment (IDE), enabling developers to write the code and
 compile apps that can be used on a variety of different devices and operating
 systems 
\begin_inset CommandInset citation
LatexCommand citep
key "AInsider-Xcode"
literal "false"

\end_inset

.
 It also includes a unified macOS SDK that includes all the frameworks,
 compilers, debuggers, and other tools you need to build apps that run natively
 on Apple Silicon and the Intel x86_64 CPU 
\begin_inset CommandInset citation
LatexCommand citep
key "Apple-Xcode"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Related Work
\end_layout

\begin_layout Standard
Below are described some project examples related with the topics presented
 in this work.
\end_layout

\begin_layout Subsubsection
Machine learning in geoscience
\end_layout

\begin_layout Standard
Over the last decade, there has been considerable progress in developing
 methodologies based in machine learning for many of Earth Science applications
 
\begin_inset CommandInset citation
LatexCommand citep
key "Lary2018"
literal "false"

\end_inset

.
 The following articles apply machine learning to resolve geoscience problems
 with images and geochemical data.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset

, Maitre et al.
 worked on the automated recognition of mineral grains based on machine
 learning algorithms.
 They used labeled data of different species of mineral grains (plagioclase,
 augite, background, hypersthene, ilmenite, magnetite, titanite, hornblende)
 to train the supervised algorithms of K-Nearest Neighbors (KNN), Random
 Forest (RF), and Classification and Regression Trees (CART).
 They reached efficient results with machine learning approach and also
 compared them with Optical Microscopy and automated Scanning Electron Microscop
y approaches.
\end_layout

\begin_layout Standard
To illustrate the power of multivariate classification with machine learning
 methods applied on geochemical data, 
\begin_inset CommandInset citation
LatexCommand citep
key "Cate2018"
literal "false"

\end_inset

 studies drillhole geochemical data from altered volcanic rocks (extrusive
 igneous rocks) hosting the volcanogenic massive sulphide (VMS) Lalor deposit
 in the Snow Lake area in Manitoba, Canada.
 They tested the machine learning algortihms of K-Nearest Neighbors, Gaussian
 naïve Bayesian, Support Vector Machine, Random Forest, Gradient Tree Boosting
 in different sets of the geochemical variables to classify the volcanic
 rocks units and their alteration type.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Hasterok2019"
literal "false"

\end_inset

, the authors survey the eﬃcacy of several machine learning techniques to
 predict the protolith class (igneous or sedimentary) for whole rock geochemical
 analyses using 9 major oxides (SiO
\begin_inset script subscript

\begin_layout Plain Layout
2
\end_layout

\end_inset

, TiO
\begin_inset script subscript

\begin_layout Plain Layout
2
\end_layout

\end_inset

, Al
\begin_inset script subscript

\begin_layout Plain Layout
2
\end_layout

\end_inset

O
\begin_inset script subscript

\begin_layout Plain Layout
3
\end_layout

\end_inset

, FeO
\begin_inset script subscript

\begin_layout Plain Layout

\shape italic
T
\end_layout

\end_inset

, MgO, CaO, Na
\begin_inset script subscript

\begin_layout Plain Layout
2
\end_layout

\end_inset

O, K
\begin_inset script subscript

\begin_layout Plain Layout
2
\end_layout

\end_inset

O, P
\begin_inset script subscript

\begin_layout Plain Layout
2
\end_layout

\end_inset

O
\begin_inset script subscript

\begin_layout Plain Layout
5
\end_layout

\end_inset

).
 They compared the results with the obtained on chemical scatter plots.
\end_layout

\begin_layout Subsubsection
Feature extraction from images used in machine learning
\end_layout

\begin_layout Standard
The following articles show that the extraction of features play an important
 role to detect objects with machine learning.
\end_layout

\begin_layout Standard
Also in 
\begin_inset CommandInset citation
LatexCommand citep
key "Maitre2019"
literal "false"

\end_inset

, the authors utilize feature extraction from superpixels to decrease the
 complexity of image processing tasks before train the machine learning
 algorithms.
 The initial idea of this method is described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Li2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
The purpose in 
\begin_inset CommandInset citation
LatexCommand citep
key "Kavitha2016"
literal "false"

\end_inset

, is to classify dermoscopy images into melanoma and non-melanoma by considering
 the texture and color features of an image.
 Color histograms are used to extract the color features in three color
 spaces namely RGB, HSV and OPP.
 Support vector machine (SVM) is used for the process of classification.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "S.Patil2012"
literal "false"

\end_inset

, the color feature extraction technique that considers the image color
 distribution is used on a content-based image retrieval system (CBIR) to
 search for digital images in a large dataset.
 For the color feature extraction process they use the clustering method,
 where fixed number of clusters and variable number of clusters are formed.
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Subsection
Methodology
\end_layout

\begin_layout Standard
This section details each of the steps followed to obtain the best machine
 learning algorithm for the mobile application.
\end_layout

\begin_layout Subsubsection
Data description
\end_layout

\begin_layout Standard
The original images were provided by the Loma Linda University.
 There were selected four classes of plutonics rocks from it.
 That classes were granite, granodiorite, gabbro, and diorite with a total
 of 81 images.
 Table 1 shows the number of images per class.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Number of images per class
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{5}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[7em]{
\backslash
B Class} &
\backslash
makebox[7em]{
\backslash
B Number of images}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granite & 16 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granodiorite & 21 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Gabbro & 19 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Diorite & 25 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Total of images & 
\backslash
B 81 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The images used in the following experiments are available online.
\end_layout

\begin_layout Subsubsection
Data preparation
\end_layout

\begin_layout Standard
In this step the images were processed with a function that iterates over
 the images directory.
 This function returns a tuple composed of a features array and an array
 of label classes in string format.
 It is shown in listing 1.
\end_layout

\begin_layout Standard
In lines 22 to 34, the string path is converted to a directory and supported
 with 
\begin_inset Quotes eld
\end_inset

load_images_from_directory
\begin_inset Quotes erd
\end_inset

 function (lines 6 to 20) that extracts the images from a folder.
 It assigns a label to each image according to the folder that contains
 it.
 For that reason it is necessary that all the images are grouped according
 to the type of rock to which they belong..
 In line 13 the images are loaded with Image.open function imported from
 PIL package.
 In line 14 there is used the ImageOps.fit function from PIL package to crop
 the image to fill the center and not lose the aspect ratio.
 This step is very important because you can choose the right size and aspect
 of the image.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/load images.txt"
lstparams "language=Python,breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\\scriptsize\\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\\scriptsize\\ttfamily},xleftmargin={0.9cm},numbersep=8pt,caption={Function to load images},label={load images}"

\end_inset


\end_layout

\begin_layout Subsubsection
Color extraction
\end_layout

\begin_layout Standard
K-means algorithm works by separating the pixels into K groups (clusters)
 of similarly coloured pixels.
 The colors at each cluster center will reflect the average of the attributes
 of all members of a cluster, and that will help us determine the dominant
 colors in the image.
\end_layout

\begin_layout Standard
First, a function in Python was created.
 That function receives an array of three dimensions representinng the image
 pixels, and returns an array of sixteen elements (the four RGB main colors
 and their percentage).
 The number of main extracted colors is determined by the number of clusters
 in the k-means algortihm.
 In listing 2 this number is stored in 
\begin_inset Quotes eld
\end_inset

CLUSTERS
\begin_inset Quotes erd
\end_inset

 variable.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/get dominant colors function.txt"
lstparams "language=Python,breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\\scriptsize\\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\\scriptsize\\ttfamily},xleftmargin={0.9cm},numbersep=8pt,caption={Function to extract dominant colors from an image},label={get dominant colors function}"

\end_inset


\end_layout

\begin_layout Standard
In line 5, the input image is reshaped into a two dimensional array, multiplying
 width and height as the first new dimension and selecting the number of
 color channels as the second dimension.
\end_layout

\begin_layout Standard
In line 6 the k-means algorithm is used.
 It works by separating the pixels into K groups (clusters) of similarly
 coloured pixels.
 The colors at each cluster center will reflect the average of the attributes
 of all members of that cluster, helping us to determine the dominant color
 in that cluster.
\end_layout

\begin_layout Standard
In lines 8, 9, and 10, the percentage of each cluster color in the image
 are calculated by creating a histogram of the k-means algorithm labels,
 that stores the number of pixels in each cluster.
 After that, each element in the histogram array is divided into the total
 of pixels (the sum of the value of the histogram elements) and we get an
 array of four percentages, one per cluster.
\end_layout

\begin_layout Standard
In line 16, the zip of colors and percenatges is iterated to create an one
 dimensional array of sixteen elements that is the three RGB values of each
 cluster color followed by the percent of that main color present in the
 image.
\end_layout

\begin_layout Standard
In listing 3, the original array of image data is iterated to extract the
 dominant colors with the previous explained function in listing 2, and
 added to a new array of only extracted main colors.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/Iterate in data to extract colors.txt"
lstparams "language=Python,breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\\scriptsize\\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\\scriptsize\\ttfamily},xleftmargin={0.9cm},numbersep=8pt,caption={Iterate original data to extract dominant colors},label={Iterate in data to extract colors}"

\end_inset


\end_layout

\begin_layout Standard
Finally, in listing 3 line 6, these extracted colors and their rock type
 labels will be saved in a csv file that will be used to train the models
 of the experiment.
\end_layout

\begin_layout Subsubsection
Normalize extracted colors data
\end_layout

\begin_layout Subsubsection
Training of the different algorithms
\end_layout

\begin_layout Standard
Five machine learning algortihms were trained for this experiment.
 They are Logistic Regression, K-Nearest Neighbors, Decision Trees, Support
 Vector Machines, and a Convolutional Neural Network.
 First, the data extracted from CSV was stored in Numpy array to normalize
 them and train the algorithms.
 Below, listing 4 presents this process and the paremeters used to train
 each classifier.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "Code/train models.txt"
lstparams "language=Python,breaklines=true,captionpos=b,aboveskip=3mm,belowskip=3mm,showstringspaces=false,columns=flexible,basicstyle={\\scriptsize\\ttfamily},breakatwhitespace=true,numbers=left,numberstyle={\\scriptsize\\ttfamily},xleftmargin={0.9cm},numbersep=8pt,caption={Normalizing data and training models},label={train models}"

\end_inset


\end_layout

\begin_layout Standard
Lines 2 to 4 are the importing, declaration and fitting of the Logistic
 Regression algorithm.
 Lines 7 to 9 and lines 12 to 14 shows the K-Nearest Neighbors and Decision
 Trees algorithms respectively.
 And finally, the Support Vector machine and Convolutional Neural Networks
 are in lines 17 to 19 and 22 to 30 respectively.
\end_layout

\begin_layout Subsubsection
Evaluation of the algorithms
\end_layout

\begin_layout Standard
Evaluating a model is a core part of building an effective machine learning
 project.
 For this purpose are used the following four metrics to evaluate the algorithms
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mishra2018"
literal "false"

\end_inset

:
\end_layout

\begin_layout Itemize
Accuracy is the ratio of number of correct predictions to the total number
 of input samples.
\begin_inset Formula 
\[
Accuracy=\frac{CorrectPredictions}{PredictionsMade}
\]

\end_inset


\end_layout

\begin_layout Itemize
Precision is the number of correct positive results divided by the number
 of positive results predicted by the classifier.
\begin_inset Formula 
\[
Precision=\frac{TP}{TP+FP}
\]

\end_inset


\end_layout

\begin_layout Itemize
Recall is the number of correct positive results divided by the number of
 all relevant samples (all samples that should have been identified as positive).
 
\begin_inset Formula 
\[
Recall=\frac{TP}{TP+FN}
\]

\end_inset


\end_layout

\begin_layout Itemize
F1-score is used to measure a test’s accuracy, the Harmonic Mean between
 precision and recall.
 It tells you how precise your classifier is (how many instances it classifies
 correctly), as well as how robust it is (it does not miss a significant
 number of instances).
 The greater the F1 Score, the better is the performance of our model.
\begin_inset Formula 
\[
F1=2*\frac{Precision*Recall}{Precision+Recall}
\]

\end_inset


\end_layout

\begin_layout Standard
Table 2 shows the accuracy of all the algorithms.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of the algorithms in terms of accuracy
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{2}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[8em]{
\backslash
B Model} &
\backslash
makebox[3.5em]{
\backslash
B Accuracy} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Logistic Regression & 0.29 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

K-Nearest Neighbors & 0.82 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Decision Trees & 0.70 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Support Vector Machine & 0.41 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Convolutional Neural Network & 0.41 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Average & 
\backslash
B 0.52 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Tables 3-7 show the results of each model evaluation in terms of precision,
 recall and F1-score.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Logistic Regression
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{4}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[5em]{
\backslash
B Class} &
\backslash
makebox[5em]{
\backslash
B Precision} &
\backslash
makebox[5em]{
\backslash
B Recall} &
\backslash
makebox[5em]{
\backslash
B F1-Score}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granite & 1.00 & 1.00 & 1.00 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granodiorite & 0.86 & 1.00 & 0.92 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Gabbro &  0.50 & 1.00 & 0.67 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Diorite & 1.00 & 0.57 & 0.73 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Average & 
\backslash
B 0.84 & 
\backslash
B 0.89 & 
\backslash
B 0.83 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of K-Nearest Neighbors
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{4}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[5em]{
\backslash
B Class} &
\backslash
makebox[5em]{
\backslash
B Precision} &
\backslash
makebox[5em]{
\backslash
B Recall} &
\backslash
makebox[5em]{
\backslash
B F1-Score}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granite & 1.00 & 1.00 & 1.00 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granodiorite & 0.86 & 1.00 & 0.92 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Gabbro & 0.50 & 1.00 & 0.67 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Diorite & 1.00 & 0.57 & 0.73 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Average & 
\backslash
B 0.84 & 
\backslash
B 0.89 & 
\backslash
B 0.83 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Decision Trees
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{4}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[5em]{
\backslash
B Class} &
\backslash
makebox[5em]{
\backslash
B Precision} &
\backslash
makebox[5em]{
\backslash
B Recall} &
\backslash
makebox[5em]{
\backslash
B F1-Score}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granite & 1.00 & 0.50 & 0.67 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granodiorite & 0.62 & 0.83 & 0.71 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Gabbro & 1.00 & 1.00 & 1.00 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Diorite & 0.67 & 0.57 & 0.62 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Average & 
\backslash
B 0.82 & 
\backslash
B 0.73 & 
\backslash
B 0.75 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Support Vector Machine
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{4}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[5em]{
\backslash
B Class} &
\backslash
makebox[5em]{
\backslash
B Precision} &
\backslash
makebox[5em]{
\backslash
B Recall} &
\backslash
makebox[5em]{
\backslash
B F1-Score}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granite & 0.50 & 0.50 & 0.50 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granodiorite & 0.40 & 0.67 & 0.50 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Gabbro & 0.40 & 1.00 & 0.57 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Diorite & 0.00 & 0.00 & 0.00 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Average & 
\backslash
B 0.33 & 
\backslash
B 0.54 & 
\backslash
B 0.39 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of Convolutional Neural Network
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
arraystretch}{1.1}
\end_layout

\begin_layout Plain Layout


\backslash
newrobustcmd{
\backslash
B}{
\backslash
bfseries}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tabular}{|l|*{4}{c|}}
\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
makebox[5em]{
\backslash
B Class} &
\backslash
makebox[5em]{
\backslash
B Precision} &
\backslash
makebox[5em]{
\backslash
B Recall} &
\backslash
makebox[5em]{
\backslash
B F1-Score}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granite & 0.00 & 0.00 & 0.00 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Granodiorite & 0.42 & 0.83 & 0.56 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Gabbro & 0.40 & 1.00 & 0.57 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout

Diorite & 0.00 & 0.00 & 0.00 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
B Average & 
\backslash
B 0.20 & 
\backslash
B 0.46 & 
\backslash
B 0.28 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hline
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Results
\end_layout

\begin_layout Standard
Here are covered the results of the color extraction step presented in this
 paper and the creation of the iOS mobile application with the implementation
 of the best algorithm.
\end_layout

\begin_layout Standard
To develope this application it was used a pod from Tensorflow Lite from
 Tensorflow to read the tflite file of the exported model and the DominantColor
 pod from Indragie Karunaratne for dominant color extraction in Swift 5.0
 that implements K-means algorithm.
\end_layout

\begin_layout Standard
In this study, four classification models were created with a convolutional
 neural network developed with TensorFlow for the classification of plutonic
 rocks.
 Specifically, several images of gabbro, granite, and granodiorite samples
 were used in the experiments, each class having 97 images.
 The best result was obtained with the classification model for granite
 and granodiorite.
 The evaluation of this model was satisfactory, with an accuracy of 73.03%
 and precision, recall, and F1 score values of 86%.
 We created a mobile application for Android devices that uses this classificati
on model to return the class of an image from a granite or granodiorite
 rock sample.
 As future work, a larger number of plutonic rock images will be obtained
 for other classes.
 With the extended dataset, we expect to extend our mobile application with
 a new classification model able to classify rocks for a wide range of plutonic
 rocks.
 Also, we will avoid cutting out original pictures into several patches,
 such as in the case of gabbro, in order to avoid low evaluation results
 in the models trained with some image combinations.
 
\end_layout

\begin_layout Subsection
Discussion
\end_layout

\begin_layout Standard
We developed an Android mobile application capable of detecting two classes
 of plutonic rocks (granite and granodi- orite).
 The accuracy of the model was 73.03%.
 The values for precision, recall, and F1 score were 86%.
\end_layout

\begin_layout Section
Conclusions and Future Work
\end_layout

\begin_layout Standard
In this study, four classification models were created with a convolutional
 neural network developed with TensorFlow for the classification of plutonic
 rocks.
 Specifically, several images of gabbro, granite, and granodiorite samples
 were used in the experiments, each class having 97 images.
 The best result was obtained with the classification model for granite
 and granodiorite.
 The evaluation of this model was satisfactory, with an accuracy of 73.03%
 and precision, recall, and F1 score values of 86%.
 We created a mobile application for Android devices that uses this classificati
on model to return the class of an image from a granite or granodiorite
 rock sample.
 As future work, a larger number of plutonic rock images will be obtained
 for other classes.
 With the extended dataset, we expect to extend our mobile application with
 a new classification model able to classify rocks for a wide range of plutonic
 rocks.
 Also, we will avoid cutting out original pictures into several patches,
 such as in the case of gabbro, in order to avoid low evaluation results
 in the models trained with some image combinations.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Newpage clearpage
\end_inset


\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "Rocks"
options "bibtotoc"

\end_inset


\end_layout

\end_body
\end_document
